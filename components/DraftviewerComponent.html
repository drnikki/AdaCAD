<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>adacad-weaver documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	    <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">adacad-weaver documentation</a>
            <button type="button" class="btn btn-default btn-menu fa fa-bars" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
            <div id="book-search-input" role="search">
                <input type="text" placeholder="Type to search">
            </div>
            <nav>
            
                <ul class="list">
            
                    <li class="title">
                        <a href="../">adacad-weaver documentation</a>
                    </li>
            
                    <li class="divider"></li>
            
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../"><span class="fa fa-home"></span>Getting started</a>
                        <ul class="links">
                                <li class="link">
                                    <a href="../" ><span class="fa fa-file-text-o"></span>README</a>
                                </li>
                                <li class="link">
                                    <a 
                                        
                                         href="../overview.html" 
                                         href="../overview.html" 
                                        >
                                        <span class="fa fa-th"></span>Overview
                                    </a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="./modules.html" >
                            <span class="fa fa-archive"></span>
                            <span>Modules</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-modules-links"
                            ></span>
                        </a>
                        <ul class="links collapse in"
                                id="xs-modules-links"
                            >
                                <li class="link">
                                    <a href="../modules/AppModule.html" >AppModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/AppRoutingModule.html" >AppRoutingModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/CoreModule.html" >CoreModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/MixerModule.html" >MixerModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/WeaverModule.html" >WeaverModule</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-cogs"></span>
                            <span>Components</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-components-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-components-links"
                            >
                                <li class="link">
                                    <a href="../components/AboutModal.html" >AboutModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/ActionsComponent.html" >ActionsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/AppComponent.html" >AppComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/ConnectionComponent.html" >ConnectionComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/ConnectionModal.html" >ConnectionModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/DraftdetailComponent.html" >DraftdetailComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/DraftviewerComponent.html"  class="active" >DraftviewerComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/ImageComponent.html" >ImageComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/InitModal.html" >InitModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/LoomComponent.html" >LoomComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/LoomModal.html" >LoomModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MaterialModal.html" >MaterialModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MaterialsComponent.html" >MaterialsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerComponent.html" >MixerComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerDesignComponent.html" >MixerDesignComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerInitComponent.html" >MixerInitComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerPatternsComponent.html" >MixerPatternsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerViewComponent.html" >MixerViewComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerViewComponent.html" >MixerViewComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MlModal.html" >MlModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/NoteComponent.html" >NoteComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/NotesComponent.html" >NotesComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/OpHelpModal.html" >OpHelpModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/OperationComponent.html" >OperationComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/OpsComponent.html" >OpsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/PaletteComponent.html" >PaletteComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/PatternModal.html" >PatternModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/PatternsComponent.html" >PatternsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SchematicComponent.html" >SchematicComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SelectionComponent.html" >SelectionComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/ShuttlesModal.html" >ShuttlesModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SidebarComponent.html" >SidebarComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SnackbarComponent.html" >SnackbarComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SubdraftComponent.html" >SubdraftComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SystemsComponent.html" >SystemsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/TabComponent.html" >TabComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/TopbarComponent.html" >TopbarComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/TreeComponent.html" >TreeComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/UploadFormComponent.html" >UploadFormComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/WeaverComponent.html" >WeaverComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/WeaverDesignComponent.html" >WeaverDesignComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/WeaverViewComponent.html" >WeaverViewComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/WeaverViewComponent.html" >WeaverViewComponent</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-code"></span>
                            <span>Directives</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-directives-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-directives-links"
                            >
                                <li class="link">
                                    <a href="../directives/MarqueeComponent.html" >MarqueeComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../directives/SelectionComponent.html" >SelectionComponent</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-file-code-o"></span>
                            <span>Classes</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-classes-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-classes-links"
                            >
                                <li class="link">
                                    <a href="../classes/AdaCADWeaverPage.html" >AdaCADWeaverPage</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Cell.html" >Cell</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Connection.html" >Connection</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Draft.html" >Draft</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Loom.html" >Loom</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Pattern.html" >Pattern</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Point.html" >Point</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Render.html" >Render</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Selection.html" >Selection</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Shape.html" >Shape</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Shuttle.html" >Shuttle</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/System.html" >System</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Timeline.html" >Timeline</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Upload.html" >Upload</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Util.html" >Util</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../routes.html" ><span class="fa fa-code-fork"></span>Routes</a>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-long-arrow-down"></span>
                            <span>Injectables</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-injectables-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-injectables-links"
                            >
                                <li class="link">
                                    <a href="../injectables/CollectionService.html" >CollectionService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/DesignmodesService.html" >DesignmodesService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/FabricssimService.html" >FabricssimService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/FileService.html" >FileService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/GloballoomService.html" >GloballoomService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/InkService.html" >InkService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/LayersService.html" >LayersService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/MaterialsService.html" >MaterialsService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/NotesService.html" >NotesService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/OperationService.html" >OperationService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/PatternService.html" >PatternService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/PatternfinderService.html" >PatternfinderService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/SystemsService.html" >SystemsService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/TreeService.html" >TreeService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/UploadService.html" >UploadService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/VaeService.html" >VaeService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/ViewportService.html" >ViewportService</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-info"></span>
                            <span>Interfaces</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-interfaces-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-interfaces-links"
                            >
                                <li class="link">
                                    <a href="../interfaces/Bounds.html" >Bounds</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Crossing.html" >Crossing</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/CxnComponentProxy.html" >CxnComponentProxy</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DensityUnits.html" >DensityUnits</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DesignActions.html" >DesignActions</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DesignMode.html" >DesignMode</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DraftMap.html" >DraftMap</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/FileObj.html" >FileObj</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/FileSaver.html" >FileSaver</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Fileloader.html" >Fileloader</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/HistoryState.html" >HistoryState</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Ink.html" >Ink</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Interlacement.html" >Interlacement</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/InterlacementVal.html" >InterlacementVal</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/LoadResponse.html" >LoadResponse</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/LoomCoords.html" >LoomCoords</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/LoomTypes.html" >LoomTypes</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/LoomUpdate.html" >LoomUpdate</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/MaterialMap.html" >MaterialMap</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/MaterialTypes.html" >MaterialTypes</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Model.html" >Model</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/NodeComponentProxy.html" >NodeComponentProxy</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Note.html" >Note</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/OpComponentProxy.html" >OpComponentProxy</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Operation.html" >Operation</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/OperationClassification.html" >OperationClassification</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/OperationParams.html" >OperationParams</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Point.html" >Point</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/SaveObj.html" >SaveObj</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/StartOptions.html" >StartOptions</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/StatusMessage.html" >StatusMessage</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/TreeNode.html" >TreeNode</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/TreeNodeProxy.html" >TreeNodeProxy</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Vertex.html" >Vertex</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/ViewModes.html" >ViewModes</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/YarnPath.html" >YarnPath</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-plus"></span>
                            <span>Pipes</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-pipes-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-pipes-links"
                            >
                                <li class="link">
                                    <a href="../pipes/FilterPipe.html" >FilterPipe</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../miscellaneous.html" ><span class="fa fa-cubes"></span>Miscellaneous</a>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../coverage.html" ><span class="fa fa-tasks"></span>Documentation coverage</a>
                    </li>
            
                    <li class="divider"></li>
                    <li class="copyright">
                            Documentation generated using <a href="https://compodoc.github.io/compodoc/" target="_blank">
                                        <img src="..//images/compodoc-vectorise.svg" class="img-responsive">
                            </a>
                    </li>
            
                </ul>
            
            </nav>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <nav>
                   
                       <ul class="list">
                   
                           <li class="title">
                               <a href="../">adacad-weaver documentation</a>
                           </li>
                   
                           <li class="divider"></li>
                   
                               <div id="book-search-input" role="search">
                                   <input type="text" placeholder="Type to search">
                               </div>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../"><span class="fa fa-home"></span>Getting started</a>
                               <ul class="links">
                                       <li class="link">
                                           <a href="../" ><span class="fa fa-file-text-o"></span>README</a>
                                       </li>
                                       <li class="link">
                                           <a 
                                               
                                                href="../overview.html" 
                                                href="../overview.html" 
                                               >
                                               <span class="fa fa-th"></span>Overview
                                           </a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="./modules.html" >
                                   <span class="fa fa-archive"></span>
                                   <span>Modules</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#modules-links"
                                   ></span>
                               </a>
                               <ul class="links collapse in"
                                       id="modules-links"
                   >
                                       <li class="link">
                                           <a href="../modules/AppModule.html" >AppModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/AppRoutingModule.html" >AppRoutingModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/CoreModule.html" >CoreModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/MixerModule.html" >MixerModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/WeaverModule.html" >WeaverModule</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-cogs"></span>
                                   <span>Components</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#components-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="components-links"
                   >
                                       <li class="link">
                                           <a href="../components/AboutModal.html" >AboutModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/ActionsComponent.html" >ActionsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/AppComponent.html" >AppComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/ConnectionComponent.html" >ConnectionComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/ConnectionModal.html" >ConnectionModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/DraftdetailComponent.html" >DraftdetailComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/DraftviewerComponent.html"  class="active" >DraftviewerComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/ImageComponent.html" >ImageComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/InitModal.html" >InitModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/LoomComponent.html" >LoomComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/LoomModal.html" >LoomModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MaterialModal.html" >MaterialModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MaterialsComponent.html" >MaterialsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerComponent.html" >MixerComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerDesignComponent.html" >MixerDesignComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerInitComponent.html" >MixerInitComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerPatternsComponent.html" >MixerPatternsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerViewComponent.html" >MixerViewComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerViewComponent.html" >MixerViewComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MlModal.html" >MlModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/NoteComponent.html" >NoteComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/NotesComponent.html" >NotesComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/OpHelpModal.html" >OpHelpModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/OperationComponent.html" >OperationComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/OpsComponent.html" >OpsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/PaletteComponent.html" >PaletteComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/PatternModal.html" >PatternModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/PatternsComponent.html" >PatternsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SchematicComponent.html" >SchematicComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SelectionComponent.html" >SelectionComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/ShuttlesModal.html" >ShuttlesModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SidebarComponent.html" >SidebarComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SnackbarComponent.html" >SnackbarComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SubdraftComponent.html" >SubdraftComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SystemsComponent.html" >SystemsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/TabComponent.html" >TabComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/TopbarComponent.html" >TopbarComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/TreeComponent.html" >TreeComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/UploadFormComponent.html" >UploadFormComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/WeaverComponent.html" >WeaverComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/WeaverDesignComponent.html" >WeaverDesignComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/WeaverViewComponent.html" >WeaverViewComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/WeaverViewComponent.html" >WeaverViewComponent</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-code"></span>
                                   <span>Directives</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#directives-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="directives-links"
                   >
                                       <li class="link">
                                           <a href="../directives/MarqueeComponent.html" >MarqueeComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../directives/SelectionComponent.html" >SelectionComponent</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-file-code-o"></span>
                                   <span>Classes</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#classes-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="classes-links"
                   >
                                       <li class="link">
                                           <a href="../classes/AdaCADWeaverPage.html" >AdaCADWeaverPage</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Cell.html" >Cell</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Connection.html" >Connection</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Draft.html" >Draft</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Loom.html" >Loom</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Pattern.html" >Pattern</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Point.html" >Point</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Render.html" >Render</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Selection.html" >Selection</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Shape.html" >Shape</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Shuttle.html" >Shuttle</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/System.html" >System</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Timeline.html" >Timeline</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Upload.html" >Upload</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Util.html" >Util</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../routes.html" ><span class="fa fa-code-fork"></span>Routes</a>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-long-arrow-down"></span>
                                   <span>Injectables</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#injectables-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="injectables-links"
                   >
                                       <li class="link">
                                           <a href="../injectables/CollectionService.html" >CollectionService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/DesignmodesService.html" >DesignmodesService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/FabricssimService.html" >FabricssimService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/FileService.html" >FileService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/GloballoomService.html" >GloballoomService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/InkService.html" >InkService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/LayersService.html" >LayersService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/MaterialsService.html" >MaterialsService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/NotesService.html" >NotesService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/OperationService.html" >OperationService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/PatternService.html" >PatternService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/PatternfinderService.html" >PatternfinderService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/SystemsService.html" >SystemsService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/TreeService.html" >TreeService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/UploadService.html" >UploadService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/VaeService.html" >VaeService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/ViewportService.html" >ViewportService</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-info"></span>
                                   <span>Interfaces</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#interfaces-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="interfaces-links"
                   >
                                       <li class="link">
                                           <a href="../interfaces/Bounds.html" >Bounds</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Crossing.html" >Crossing</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/CxnComponentProxy.html" >CxnComponentProxy</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DensityUnits.html" >DensityUnits</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DesignActions.html" >DesignActions</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DesignMode.html" >DesignMode</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DraftMap.html" >DraftMap</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/FileObj.html" >FileObj</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/FileSaver.html" >FileSaver</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Fileloader.html" >Fileloader</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/HistoryState.html" >HistoryState</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Ink.html" >Ink</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Interlacement.html" >Interlacement</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/InterlacementVal.html" >InterlacementVal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/LoadResponse.html" >LoadResponse</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/LoomCoords.html" >LoomCoords</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/LoomTypes.html" >LoomTypes</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/LoomUpdate.html" >LoomUpdate</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/MaterialMap.html" >MaterialMap</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/MaterialTypes.html" >MaterialTypes</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Model.html" >Model</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/NodeComponentProxy.html" >NodeComponentProxy</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Note.html" >Note</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/OpComponentProxy.html" >OpComponentProxy</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Operation.html" >Operation</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/OperationClassification.html" >OperationClassification</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/OperationParams.html" >OperationParams</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Point.html" >Point</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/SaveObj.html" >SaveObj</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/StartOptions.html" >StartOptions</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/StatusMessage.html" >StatusMessage</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/TreeNode.html" >TreeNode</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/TreeNodeProxy.html" >TreeNodeProxy</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Vertex.html" >Vertex</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/ViewModes.html" >ViewModes</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/YarnPath.html" >YarnPath</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-plus"></span>
                                   <span>Pipes</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#pipes-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="pipes-links"
                   >
                                       <li class="link">
                                           <a href="../pipes/FilterPipe.html" >FilterPipe</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../miscellaneous.html" ><span class="fa fa-cubes"></span>Miscellaneous</a>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../coverage.html" ><span class="fa fa-tasks"></span>Documentation coverage</a>
                           </li>
                   
                           <li class="divider"></li>
                           <li class="copyright">
                                   Documentation generated using <a href="https://compodoc.github.io/compodoc/" target="_blank">
                                               <img src="..//images/compodoc-vectorise.svg" class="img-responsive">
                                   </a>
                           </li>
                   
                       </ul>
                   
                   </nav>
               </div>
               <div class="content component">
                   <div class="content-data">


<ol class="breadcrumb">
  <li>Components</li>
  <li>DraftviewerComponent</li>
</ol>


    <ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#infos" id="infos-tab" role="tab" data-toggle="tab">Infos</a>
        </li>
        <li>
            <a href="#source" role="tab" id="source-tab" data-toggle="tab">Source</a>
        </li>
    </ul>

    <div class="tab-content">
        <div class="tab-pane fade active in" id="infos"><p class="comment">
    <h3>File</h3>
</p>
<p class="comment">
    <code>src/app/core/draftviewer/draftviewer.component.ts</code>
</p>



<section>
    <h3>Metadata</h3>
    <table class="table table-sm table-hover">
        <tbody>












            <tr>
                <td class="col-md-3">selector</td>
                <td class="col-md-9"><code>app-draftviewer</code></td>
            </tr>

            <tr>
                <td class="col-md-3">styleUrls</td>
                <td class="col-md-9"><code>draftviewer.component.scss</code></td>
            </tr>



            <tr>
                <td class="col-md-3">templateUrl</td>
                <td class="col-md-9"><code>draftviewer.component.html</code></td>
            </tr>


        </tbody>
    </table>
</section>

    <section>
        <h3 id="inputs">Inputs</h3>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-2">
                            <code>copy</code>
                        </td>
                        <td class="col-md-10">
                              <p>
                                <em>Type:</em>    <code><a href="../classes/Pattern.html" target="_self" >Pattern</a></code>

                              </p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-2">
                            <code>draft</code>
                        </td>
                        <td class="col-md-10">
                            <div><p>Contains the name of the brush being used to manipulate the weave draft.<br>It is defined and inputed from the HTML declaration of the WeaveDirective.<br>The Draft object containing the pattern and shuttle information.<br>It is defined and inputed from the HTML declaration of the WeaveDirective.</p>
</div>
                              <p>
                                <em>Type:</em>    <code><a href="../classes/Draft.html" target="_self" >Draft</a></code>

                              </p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-2">
                            <code>loom</code>
                        </td>
                        <td class="col-md-10">
                            <div><p>The Draft object containing the pattern and shuttle information.<br>It is defined and inputed from the HTML declaration of the WeaveDirective.</p>
</div>
                              <p>
                                <em>Type:</em>    <code><a href="../classes/Loom.html" target="_self" >Loom</a></code>

                              </p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-2">
                            <code>render</code>
                        </td>
                        <td class="col-md-10">
                            <div><p>The Render object containing the variables about zoom and cell sizes.<br>It is defined and inputed from the HTML declaration of the WeaveDirective.</p>
</div>
                              <p>
                                <em>Type:</em>    <code><a href="../classes/Render.html" target="_self" >Render</a></code>

                              </p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-2">
                            <code>source</code>
                        </td>
                        <td class="col-md-10">
                            <div><p>a descriptor of the parent who generated this window</p>
</div>
                              <p>
                                <em>Type:</em>    <code>string</code>

                              </p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-2">
                            <code>timeline</code>
                        </td>
                        <td class="col-md-10">
                            <div><p>The Timeline object containing state histories for undo and redo</p>
</div>
                              <p>
                                <em>Type:</em>    <code>any</code>

                              </p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-2">
                            <code>viewonly</code>
                        </td>
                        <td class="col-md-10">
                              <p>
                                <em>Type:</em>    <code>boolean</code>

                              </p>
                        </td>
                    </tr>
                </tbody>
            </table>
    </section>

    <section>
        <h3 id="outputs">Outputs</h3>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-2">
                            <code>onNewSelection</code>
                        </td>
                        <td class="col-md-10">
                            <em><code>$event</code> type:</em>    <code><a href="https://angular.io/docs/ts/latest/api/core/index/EventEmitter-class.html" target="_blank" >EventEmitter</a></code>

                        </td>
                    </tr>
                </tbody>
            </table>
    </section>

    <section>
        <h3 id="constructor">Constructor</h3>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <code>constructor(fs: <a href="../injectables/FileService.html" >FileService</a>, dm: <a href="../injectables/DesignmodesService.html" >DesignmodesService</a>, ps: <a href="../injectables/PatternService.html" >PatternService</a>, ms: <a href="../injectables/MaterialsService.html" >MaterialsService</a>, ss: <a href="../injectables/SystemsService.html" >SystemsService</a>)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Creates the element reference.</p>
    </div>
                                <div class="io-description">
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
    </section>

    <section>
        <h3 id="methods">Methods</h3>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> onNewDraftLoaded</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>onNewDraftLoaded()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> clearSelection</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>clearSelection()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> setPosAndDraw</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>setPosAndDraw(target: HTMLElement, shift: boolean, currentPos: Interlacement)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>takes an event from mouse event and determines how to handle it </p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>target</b>
                                                    </div>
                                                    <div>
                                                        <p>the dom target of the mouse click</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>shift</b>
                                                    </div>
                                                    <div>
                                                        <p>whether or not the shift key is being held</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>currentPos</b>
                                                    </div>
                                                    <div>
                                                        <p>the position of the click within the target</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> onStart</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>onStart(event: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Touch start event. Subscribes to the move event.</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>event</b>
                                                            :     <code><a href="https://angular.io/docs/ts/latest/api/router/index/Event-type-alias.html" target="_blank" >Event</a></code>
    
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>The mousedown event.</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> isSame</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>isSame(p1: Interlacement, p2: Interlacement)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> onMove</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>onMove(event: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Event called when mouse down and moved within the canvas.</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>event</b>
                                                            :     <code><a href="https://angular.io/docs/ts/latest/api/router/index/Event-type-alias.html" target="_blank" >Event</a></code>
    
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>The mousemove event.</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> onEnd</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>onEnd(event: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Event removes subscription when touch has ended.</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>event</b>
                                                            :     <code><a href="https://angular.io/docs/ts/latest/api/router/index/Event-type-alias.html" target="_blank" >Event</a></code>
    
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>The mouseleave or mouseup event.</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> onSelectionEnd</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>onSelectionEnd()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>This is emitted from the selection</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> removeSubscription</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>removeSubscription()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Remove the subscription from the move event.</p>
    </div>
                                <div class="io-description">
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> copyArea</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>copyArea()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Creates the copied pattern. Hack for warp and weft shuttles is that it creates a 2d arrray representing the<br>threading or treadling with &quot;true&quot; in the frame/threadle associated with that col/row. </p>
    </div>
                                <div class="io-description">
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawWeftMaterialCell</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawWeftMaterialCell(cx: any, i: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawWeftMaterials</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawWeftMaterials(cx: any, canvas: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawWarpMaterialCell</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawWarpMaterialCell(cx: any, j: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawWarpMaterials</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawWarpMaterials(cx: any, canvas: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawWeftSelectorCell</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawWeftSelectorCell(cx: any, i: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawWeftSystems</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawWeftSystems(cx: any, canvas: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawWarpSelectorCell</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawWarpSelectorCell(cx: any, j: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawWarpSystems</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawWarpSystems(cx: any, canvas: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawBlank</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawBlank(cx: any, canvas: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Draws the grid lines onto the canvas.</p>
    </div>
                                <div class="io-description">
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawGrid</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawGrid(cx: any, canvas: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Draws the grid lines onto the canvas.</p>
    </div>
                                <div class="io-description">
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawOnWeftSelectors</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawOnWeftSelectors(currentPos: Interlacement)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Change shuttle of row to next in list. If there isn&#39;t a next in list, create a new System</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>the</b>
                                                            :     <code><a href="../classes/Point.html" target="_self" >Point</a></code>
    
                                                    </div>
                                                    <div>
                                                        <p>point of the interaction</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawOnWeftMaterials</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawOnWeftMaterials(currentPos: Interlacement)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Change shuttle of row to next in list.</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>the</b>
                                                            :     <code><a href="../classes/Point.html" target="_self" >Point</a></code>
    
                                                    </div>
                                                    <div>
                                                        <p>point of the interaction</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawOnWarpSelectors</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawOnWarpSelectors(currentPos: Interlacement)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Change column to next row in the list</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>the</b>
                                                            :     <code><a href="../classes/Point.html" target="_self" >Point</a></code>
    
                                                    </div>
                                                    <div>
                                                        <p>point of the interaction</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawOnWarpMaterials</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawOnWarpMaterials(currentPos: Interlacement)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Change column to next row in the list</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>the</b>
                                                            :     <code><a href="../classes/Point.html" target="_self" >Point</a></code>
    
                                                    </div>
                                                    <div>
                                                        <p>point of the interaction</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawOnMask</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawOnMask(currentPos: Interlacement)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Draws, inverts, or erases a single rectangle on the mask. </p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>currentPos</b>
                                                            :     <code><a href="../classes/Point.html" target="_self" >Point</a></code>
    
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>the current position of the mouse within draft.</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawOnDrawdown</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawOnDrawdown(currentPos: Interlacement, shift: boolean)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Called when a single point &quot;draw&quot; event is called on the</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>currentPos</b>
                                                            :     <code><a href="../classes/Point.html" target="_self" >Point</a></code>
    
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>the current position of the mouse within draft.</li>
    </ul>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>shift</b>
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>boolean for if the shift key was being held when this operation was called</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawOnTieups</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawOnTieups(currentPos: Interlacement)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Draws or erases a single rectangle on the canvas. Updates the tieups.</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>currentPos</b>
                                                            :     <code><a href="../classes/Point.html" target="_self" >Point</a></code>
    
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>the current position of the mouse within draft.</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawOnThreading</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawOnThreading(currentPos: Interlacement)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Draws or erases a single rectangle on the canvas. Updates the threading.</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>currentPos</b>
                                                            :     <code><a href="../classes/Point.html" target="_self" >Point</a></code>
    
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>the current position of the mouse within draft.</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawOnTreadling</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawOnTreadling(currentPos: Interlacement)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Draws or erases a single rectangle on the canvas. Updates the treadling.</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>currentPos</b>
                                                            :     <code><a href="../classes/Point.html" target="_self" >Point</a></code>
    
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>the current position of the mouse within draft.</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> maskArea</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>maskArea(pattern: boolean[][])</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Fills the visible regions of the mask with the stitch- the pattern used to fill the area.</p>
    </div>
                                <div class="io-description">
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> drawCell</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>drawCell(cx: any, i: any, j: any, type: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> drawCrossingCell</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>drawCrossingCell(cx: any, i: any, i_next: any, j: any, type: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>This view renders cells based on the relationships with their neighbords </p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> redrawRow</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>redrawRow(y: any, i: any, cx: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Redraws one row to avoid drawing the entire canvas.</p>
    </div>
                                <div class="io-description">
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> redrawCol</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play lock">
                                    <span class="fa fa-lock"></span>
                                </span>
                            <code>redrawCol(x: any, i: any, cx: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawWeft</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawWeft(top: number, shuttle: <a href="../classes/Shuttle.html" >Shuttle</a>)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>top</b>
                                                    </div>
                                                    <div>
                                                        <p>the index of this weft row</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>shuttle</b>
                                                    </div>
                                                    <div>
                                                        <p>the shuttle assigned to this row</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawWeftLeftUp</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawWeftLeftUp(top: any, left: any, shuttle: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawWeftRightUp</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawWeftRightUp(top: any, left: any, shuttle: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawWeftBottomLeft</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawWeftBottomLeft(top: any, left: any, shuttle: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawWeftBottomRight</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawWeftBottomRight(top: any, left: any, shuttle: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawWeftUp</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawWeftUp(top: any, left: any, shuttle: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawWeftStart</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawWeftStart(top: any, left: any, shuttle: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawWeftEnd</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawWeftEnd(top: any, left: any, shuttle: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawWeftOver</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawWeftOver(top: any, left: any, shuttle: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawWeftUnder</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawWeftUnder(top: any, left: any, shuttle: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> reposition</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>reposition(scroll_top: number, scroll_left: number)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>called on scroll</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>scroll_top</b>
                                                    </div>
                                                    <div>
                                                        
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>scroll_left</b>
                                                    </div>
                                                    <div>
                                                        
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> flip</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>flip()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> rescale</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>rescale(zoom: number)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>this rescales the canvas and updates the view from scroll events<br>receives offset of the scroll from the CDKScrollable created when the scroll was initiated</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawWarpsOver</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawWarpsOver()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> redrawYarnView</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>redrawYarnView()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawLoomStates</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawLoomStates(updates: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> redrawLoom</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>redrawLoom()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> recomputeLoom</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>recomputeLoom()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> unsetSelection</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>unsetSelection()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawDrawdown</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawDrawdown()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> redraw</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>redraw(flags: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> redrawDraft</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>redrawDraft()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Redraws the entire canvas based on weave pattern.</p>
    </div>
                                <div class="io-description">
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> drawWarps</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>drawWarps(cx: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> redrawCrossings</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>redrawCrossings()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Highlights intersections between yarns, when they cross from front to back</p>
    </div>
                                <div class="io-description">
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> redrawVisualView</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>redrawVisualView()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Simulates the visual look of the weave pattern.</p>
    </div>
                                <div class="io-description">
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> onUndoRedo</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>onUndoRedo()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> printPattern</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>printPattern(pattern: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Prints the pattern to the console.</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>pattern</b>
                                                            :     <code>Array</code>
    
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>2D pattern array.</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> getPrintableCanvas</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>getPrintableCanvas(obj: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Saves the draft as a bitmap file</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>fileName</b>
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>name to save file as</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>HTMLCanvasElement</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> getBMPCanvas</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>getBMPCanvas(obj: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Saves the draft as a bitmap file</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>fileName</b>
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>name to save file as</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>HTMLCanvasElement</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> insertRow</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>insertRow(si: number, i: number)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>inserts an empty row just below the clicked row</p>
    </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> cloneRow</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>cloneRow(si: number, i: number)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>clones the selected row and pastes into next visible row</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>si</b>
                                                    </div>
                                                    <div>
                                                        <p>the screen index of the row we&#39;ll insert</p>
    
                                                    </div>
                                                </li>
                                                <li>
                                                    <div>
                                                        <b>i</b>
                                                    </div>
                                                    <div>
                                                        <p>the absolute (not screen) index of the row we&#39;ll insert</p>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> deleteRow</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>deleteRow(i: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> insertCol</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>insertCol(i: any, shuttle: any, system: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>In</p>
    </div>
                                <div class="io-description">
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> cloneCol</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>cloneCol(i: any, shuttle: any, system: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> deleteCol</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>deleteCol(i: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> onFill</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>onFill(e: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Tell the weave directive to fill selection with pattern.</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>e</b>
                                                            :     <code><a href="https://angular.io/docs/ts/latest/api/router/index/Event-type-alias.html" target="_blank" >Event</a></code>
    
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>fill event from design component.</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> onClear</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>onClear(b: boolean)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Tell weave reference to clear selection.</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>Delte</b>
                                                            :     <code><a href="https://angular.io/docs/ts/latest/api/router/index/Event-type-alias.html" target="_blank" >Event</a></code>
    
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>clear event from design component.</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Public</span> onPaste</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <span class="modifier-icon method fa fa-play circle">
                                    <span class="fa fa-circle"></span>
                                </span>
                            <code>onPaste(e: any)</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Tells weave reference to paste copied pattern.</p>
    </div>
                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <ul class="jsdoc-params">
                                                <li>
                                                    <div>
                                                        <b>e</b>
                                                            :     <code><a href="https://angular.io/docs/ts/latest/api/router/index/Event-type-alias.html" target="_blank" >Event</a></code>
    
                                                    </div>
                                                    <div>
                                                        <ul>
    <li>paste event from design component.</li>
    </ul>
    
                                                    </div>
                                                </li>
                                        </ul>
                                </div>
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                                    <div class="io-description">
                                        
                                    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> onCopy</b>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
    <code>onCopy()</code>
                        </td>
                    </tr>
    
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description">
                                    <b>Returns: </b>    <code>void</code>
    
                                </div>
                        </td>
                    </tr>
                </tbody>
            </table>
    </section>

    <section>
        <h3 id="inputs">Properties</h3>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> bitmap</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>bitmap:     <code>any</code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> canvasEl</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>canvasEl:     <code>HTMLCanvasElement</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The HTML canvas element within the weave draft.</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> cx</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>cx:     <code>any</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The 2D context of the canvas</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> cxThreading</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>cxThreading:     <code>any</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The 2D context of the threading canvas</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> cxTieups</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>cxTieups:     <code>any</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The 2D context of the treadling canvas</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> cxTreadling</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>cxTreadling:     <code>any</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The 2D context of the treadling canvas</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> cxWarpMaterials</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>cxWarpMaterials:     <code>any</code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> cxWarpSystems</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>cxWarpSystems:     <code>any</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The 2D context of the warp_systems canvas</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> cxWeftMaterials</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>cxWeftMaterials:     <code>any</code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> cxWeftSystems</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>cxWeftSystems:     <code>any</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The 2D context of the weft_systems canvas</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> divViewFrames</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>divViewFrames:     <code>HTMLElement</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The HTML div element used to show and hide the frames.</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> divWasy</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>divWasy:     <code>HTMLElement</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The HTML div element used to show the warp-systems text.</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> divWesy</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>divWesy:     <code>HTMLElement</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The HTML div element used to show the weft-systems text.</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> draftContainer</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>draftContainer:     <code>HTMLElement</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>the window holding the draft.</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> flag_history</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>flag_history:     <code>boolean</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>flag defining if there needs to be a recomputation of the draft on Mouse Up</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> flag_recompute</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>flag_recompute:     <code>boolean</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>flag defining if there needs to be a recomputation of the draft on Mouse Up</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> hold_copy_for_paste</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>hold_copy_for_paste:     <code>boolean</code>
    </bcode>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                <i>Default value: </i><code>false</code>
                            </td>
                        </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> lastPos</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <span class="modifier-icon fa fa-lock"></span><code>lastPos:     <code>Interlacement</code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> moveSubscription</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>moveSubscription:     <code>Subscription</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>Subscribes to move event after a touch event is started.</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> selection</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>selection:     <code><a href="../classes/Selection.html" target="_self" >SelectionComponent</a></code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> svgSelectCol</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>svgSelectCol:     <code>HTMLElement</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The HTML SVG element used to show the row</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> svgSelectRow</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>svgSelectRow:     <code>HTMLElement</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The HTML SVG element used to show the row</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> tempPattern</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <span class="modifier-icon fa fa-lock"></span><code>tempPattern:     <code><a href="../classes/Cell.html" target="_self" >Cell[][]</a></code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> threadingCanvas</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>threadingCanvas:     <code>HTMLCanvasElement</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The HTML canvas element within the weave draft for threading.</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> tieupsCanvas</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>tieupsCanvas:     <code>HTMLCanvasElement</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The HTML canvas element within the weave draft for tieups.</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> treadlingCanvas</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>treadlingCanvas:     <code>HTMLCanvasElement</code>
    </bcode>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <div class="io-description"><p>The HTML canvas element within the weave draft for treadling.</p>
    </div>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b><span class="modifier">Private</span> unsubscribe$</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <span class="modifier-icon fa fa-lock"></span><code>unsubscribe$:     <code>Subject&lt;{}&gt;</code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> warpMaterialsCanvas</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>warpMaterialsCanvas:     <code>HTMLCanvasElement</code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> warpSystemsCanvas</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>warpSystemsCanvas:     <code>HTMLCanvasElement</code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> weftMaterialsCanvas</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>weftMaterialsCanvas:     <code>HTMLCanvasElement</code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
            <table class="table table-sm table-bordered">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <b> weftSystemsCanvas</b>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <code>weftSystemsCanvas:     <code>HTMLCanvasElement</code>
    </bcode>
                        </td>
                    </tr>
                </tbody>
            </table>
    </section>
</div>
        <div class="tab-pane fade tab-source-code" id="source">
            <pre><code class="hljs javascript">import { ComponentFactoryResolver, ElementRef, HostListener, Inject } from &#x27;@angular/core&#x27;;
import { Component, EventEmitter, Input, OnInit, Output, ViewChild } from &#x27;@angular/core&#x27;;
import { Subscription, Subject, fromEvent } from &#x27;rxjs&#x27;;
import { Render } from &#x27;../model/render&#x27;;
import { Selection } from &#x27;../model/selection&#x27;;
import { Cell } from &#x27;../model/cell&#x27;;
import { Crossing, DesignMode, Interlacement } from &#x27;../model/datatypes&#x27;;
import { Draft } from &#x27;../model/draft&#x27;;
import { Loom } from &#x27;../model/loom&#x27;;
import { Pattern } from &#x27;../model/pattern&#x27;;
import {cloneDeep, forEach, now} from &#x27;lodash&#x27;;
import { FileService } from &#x27;../provider/file.service&#x27;;
import { SelectionComponent } from &#x27;./selection/selection.component&#x27;;
import { DesignmodesService } from &#x27;../provider/designmodes.service&#x27;;
import { PatternService } from &#x27;../provider/pattern.service&#x27;;
import { MaterialsService } from &#x27;../provider/materials.service&#x27;;
import { SystemsService } from &#x27;../provider/systems.service&#x27;;
import { FabricssimService } from &#x27;../provider/fabricssim.service&#x27;;
import { Shuttle } from &#x27;../model/shuttle&#x27;;
import { cross } from &#x27;d3-array&#x27;;
import { System } from &#x27;../model/system&#x27;;

@Component({
  selector: &#x27;app-draftviewer&#x27;,
  templateUrl: &#x27;./draftviewer.component.html&#x27;,
  styleUrls: [&#x27;./draftviewer.component.scss&#x27;]
})
export class DraftviewerComponent implements OnInit {

  @ViewChild(&#x27;bitmapImage&#x27;, {static: false}) bitmap;
  @ViewChild(&#x27;selection&#x27;, {read: SelectionComponent, static: true}) selection: SelectionComponent;

  // @Input(&#x27;design_actions&#x27;)  design_actions;


  /**
   * a descriptor of the parent who generated this window
   * @property {string} will be &quot;weaver&quot; or &quot;mixer&quot;
   */
   @Input(&#x27;source&#x27;) source: string;


 /// ATTRIBUTES
  /**
   * Contains the name of the brush being used to manipulate the weave draft.
   * It is defined and inputed from the HTML declaration of the WeaveDirective.
   * @property {string}
   */
  //  @Input(&#x27;design_mode&#x27;) design_mode: any;

   /**
    * The Draft object containing the pattern and shuttle information.
    * It is defined and inputed from the HTML declaration of the WeaveDirective.
    * @property {Draft}
    */
   @Input(&#x27;draft&#x27;) weave: Draft;
 
 
   /**
  * The Draft object containing the pattern and shuttle information.
  * It is defined and inputed from the HTML declaration of the WeaveDirective.
  * @property {Draft}
  */
  @Input(&#x27;loom&#x27;) loom: Loom;
 
 
 
 /**
    * The Render object containing the variables about zoom and cell sizes.
    * It is defined and inputed from the HTML declaration of the WeaveDirective.
    * @property {Render}
   */
   @Input(&#x27;render&#x27;) render:Render;
 
 
 
 /**
    * The Timeline object containing state histories for undo and redo
    * @property {Timeline}
   */
   @Input(&#x27;timeline&#x27;) timeline: any;
 
   @Input() viewonly: boolean;
 
   @Input() copy: Pattern;
 
 
   @Output() onNewSelection &#x3D; new EventEmitter();
 
 
  hold_copy_for_paste: boolean &#x3D; false;


 /**
    * The HTML canvas element within the weave draft.
    * @property {HTMLCanvasElement}
   */ 
   canvasEl: HTMLCanvasElement;
 
 /**
    * the window holding the draft.
    * @property {HTMLCanvasElement}
   */ 
   draftContainer: HTMLElement;
 
 
   /**
    * flag defining if there needs to be a recomputation of the draft on Mouse Up
    */
   flag_recompute: boolean;
 
 
   /**
    * flag defining if there needs to be a recomputation of the draft on Mouse Up
    */
   flag_history: boolean;
 
 
   /**
    * The 2D context of the canvas
    * @property {any}
    */
   cx: any;
 
   /**
    * The 2D context of the threading canvas
    * @property {any}
    */
   cxThreading: any;
 
   /**
    * The 2D context of the treadling canvas
    * @property {any}
    */
   cxTreadling: any;
 
   /**
    * The 2D context of the treadling canvas
    * @property {any}
    */
   cxTieups: any;
 
   /**
    * The 2D context of the weft_systems canvas
    * @property {any}
    */
   cxWeftSystems: any;
 
   /**
    * The 2D context of the warp_systems canvas
    * @property {any}
    */
   cxWarpSystems: any;
 
 
   cxWarpMaterials: any;
 
 
 
   cxWeftMaterials: any;
 
 
   /**
    * Subscribes to move event after a touch event is started.
    * @property {Subscription}
    */
   moveSubscription: Subscription;
 
 
   /**
    * The HTML div element used to show the weft-systems text.
    * @property {HTMLElement}
    */
   divWesy: HTMLElement;
 
   /**
    * The HTML div element used to show the warp-systems text.
    * @property {HTMLElement}
    */
   divWasy: HTMLElement;
 
 
   /**
    * The HTML div element used to show and hide the frames.
    * @property {HTMLElement}
    */
   divViewFrames: HTMLElement;
 
 
  /**
    * The HTML SVG element used to show the row
    * @property {HTMLElement}
    */
   svgSelectRow: HTMLElement;
 
 
  /**
    * The HTML SVG element used to show the row
    * @property {HTMLElement}
    */
   svgSelectCol: HTMLElement;
 
 
   /**
    * The HTML canvas element within the weave draft for threading.
    * @property {HTMLCanvasElement}
    * 
    */
   threadingCanvas: HTMLCanvasElement;
 
     /**
    * The HTML canvas element within the weave draft for treadling.
    * @property {HTMLCanvasElement}
    * 
    */
   treadlingCanvas: HTMLCanvasElement;
 
   /**
    * The HTML canvas element within the weave draft for tieups.
    * @property {HTMLCanvasElement}
    * 
    */
   tieupsCanvas: HTMLCanvasElement;
 
 
 
   weftSystemsCanvas: HTMLCanvasElement;
   warpSystemsCanvas: HTMLCanvasElement;
 
 
   weftMaterialsCanvas: HTMLCanvasElement;
   warpMaterialsCanvas: HTMLCanvasElement;
 
   private tempPattern: Array&lt;Array&lt;Cell&gt;&gt;;
   private unsubscribe$ &#x3D; new Subject();
 
   private lastPos: Interlacement;
 
 
 
   /// ANGULAR FUNCTIONS
   /**
    * Creates the element reference.
    * @constructor
    */

  constructor(
    private fs: FileService,
    private dm: DesignmodesService,
    private ps: PatternService,
    private ms: MaterialsService,
    private ss: SystemsService
    ) { 

    this.flag_recompute &#x3D; false;
    this.flag_history &#x3D; false;

  }

  ngOnInit() {

  }

  ngAfterViewInit(){

    // define the elements and context of the weave draft, threading, treadling, and tieups.
    this.canvasEl &#x3D; &lt;HTMLCanvasElement&gt; document.getElementById(&#x27;drawdown&#x27;);
    this.draftContainer &#x3D; &lt;HTMLElement&gt; document.getElementById(&#x27;draft-container&#x27;);


  
    // this.svgSelectRow &#x3D; el.nativeElement.children[12];
    // this.svgSelectCol &#x3D; el.nativeElement.children[13];
    this.divWesy &#x3D;  document.getElementById(&#x27;weft-systems-text&#x27;);
    this.divWasy &#x3D;  document.getElementById(&#x27;warp-systems-text&#x27;);
    this.divViewFrames &#x3D; document.getElementById(&#x27;view_frames&#x27;);

    this.threadingCanvas &#x3D; &lt;HTMLCanvasElement&gt; document.getElementById(&#x27;threading&#x27;);
    this.tieupsCanvas &#x3D; &lt;HTMLCanvasElement&gt; document.getElementById(&#x27;tieups&#x27;);
    this.treadlingCanvas &#x3D; &lt;HTMLCanvasElement&gt; document.getElementById(&#x27;treadling&#x27;);
    this.weftSystemsCanvas &#x3D; &lt;HTMLCanvasElement&gt; document.getElementById(&#x27;weft-systems&#x27;);
    this.weftMaterialsCanvas &#x3D; &lt;HTMLCanvasElement&gt; document.getElementById(&#x27;weft-materials&#x27;);
    this.warpSystemsCanvas &#x3D; &lt;HTMLCanvasElement&gt; document.getElementById(&#x27;warp-systems&#x27;);
    this.warpMaterialsCanvas &#x3D;&lt;HTMLCanvasElement&gt; document.getElementById(&#x27;warp-materials&#x27;);
    
    this.cx &#x3D; this.canvasEl.getContext(&#x27;2d&#x27;);
    this.cxThreading &#x3D; this.threadingCanvas.getContext(&#x27;2d&#x27;);
    this.cxTreadling &#x3D; this.treadlingCanvas.getContext(&#x27;2d&#x27;);
    this.cxTieups &#x3D; this.tieupsCanvas.getContext(&#x27;2d&#x27;);
    this.cxWarpSystems &#x3D; this.warpSystemsCanvas.getContext(&#x27;2d&#x27;);
    this.cxWeftSystems &#x3D; this.weftSystemsCanvas.getContext(&#x27;2d&#x27;);
    this.cxWarpMaterials &#x3D; this.warpMaterialsCanvas.getContext(&#x27;2d&#x27;);
    this.cxWeftMaterials &#x3D; this.weftMaterialsCanvas.getContext(&#x27;2d&#x27;);
    // set the width and height

    this.rescale(this.render.getZoom());

  }

  //this is called anytime a new draft object is loaded. 
  onNewDraftLoaded() {  
    var dims &#x3D; this.render.getCellDims(&quot;base&quot;);

    this.canvasEl.width &#x3D; this.weave.warps * dims.w;
    this.canvasEl.height &#x3D; this.weave.wefts * dims.h;
    this.threadingCanvas.width &#x3D; this.weave.warps * dims.w;
    this.threadingCanvas.height &#x3D; this.loom.min_frames * dims.h;
    this.treadlingCanvas.height &#x3D; this.weave.wefts * dims.h;
    this.treadlingCanvas.width &#x3D; this.loom.min_treadles * dims.w;
    this.tieupsCanvas.width &#x3D; this.loom.min_treadles*dims.w;
    this.tieupsCanvas.height &#x3D; this.loom.min_frames * dims.h;


    this.weftSystemsCanvas.width &#x3D;  dims.w;
    this.weftSystemsCanvas.height &#x3D; this.weave.wefts * dims.h;
    this.weftMaterialsCanvas.width &#x3D;  dims.w;
    this.weftMaterialsCanvas.height &#x3D; this.weave.wefts * dims.h;

    this.warpSystemsCanvas.width &#x3D;  this.weave.warps * dims.w;
    this.warpSystemsCanvas.height &#x3D; dims.h;
    this.warpMaterialsCanvas.width &#x3D;  this.weave.warps * dims.w;
    this.warpMaterialsCanvas.height &#x3D; dims.h;


  }

  clearSelection(){
        this.selection.unsetParameters();
        // d3.select(this.svgSelectCol).style(&#x27;display&#x27;, &#x27;none&#x27;);
        // d3.select(this.svgSelectRow).style(&#x27;display&#x27;, &#x27;none&#x27;);
  }

  ngOnDestroy() {
     this.removeSubscription();
  }


  /**
   *  takes an event from mouse event and determines how to handle it 
   * @param target the dom target of the mouse click
   * @param shift whether or not the shift key is being held
   * @param currentPos the position of the click within the target
   */
  setPosAndDraw(target:HTMLElement, shift: boolean, currentPos:Interlacement){

      if (target &amp;&amp; target.id &#x3D;&#x3D;&#x27;treadling&#x27;) {
        if(this.viewonly) return;
        currentPos.i &#x3D; this.render.visibleRows[currentPos.i];
        this.drawOnTreadling(currentPos);
      } else if (target &amp;&amp; target.id &#x3D;&#x3D;&#x3D; &#x27;tieups&#x27;) {
        if(this.viewonly) return;
        currentPos.i &#x3D; this.loom.frame_mapping[currentPos.i];
        this.drawOnTieups(currentPos);
      } else if (target &amp;&amp; target.id &#x3D;&#x3D;&#x3D; (&#x27;threading&#x27;)) {
        if(this.viewonly) return;
        currentPos.i &#x3D; this.loom.frame_mapping[currentPos.i];
        this.drawOnThreading(currentPos);
      } else if(target &amp;&amp; target.id &#x3D;&#x3D;&#x3D; (&#x27;weft-systems&#x27;)){
        if(this.viewonly) return;
        currentPos.i &#x3D; this.render.visibleRows[currentPos.i];
        this.drawOnWeftSelectors(currentPos);
      }else if(target &amp;&amp; target.id &#x3D;&#x3D;&#x3D; (&#x27;warp-systems&#x27;)){
        if(this.viewonly) return;
        this.drawOnWarpSelectors(currentPos);
      }else if(target &amp;&amp; target.id &#x3D;&#x3D;&#x3D; (&#x27;weft-materials&#x27;)){
        if(this.viewonly) return;
        currentPos.i &#x3D; this.render.visibleRows[currentPos.i];
        if(this.viewonly) return;
        this.drawOnWeftMaterials(currentPos);
      }else if(target &amp;&amp; target.id &#x3D;&#x3D;&#x3D; (&#x27;warp-materials&#x27;)){
        if(this.viewonly) return;
        this.drawOnWarpMaterials(currentPos);
      } else{
        if(this.viewonly) return;
        currentPos.i &#x3D; this.render.visibleRows[currentPos.i];
        this.drawOnDrawdown(currentPos, shift);
      }

      this.flag_history &#x3D; true;
    }



  /**
   * Touch start event. Subscribes to the move event.
   * @extends WeaveDirective
   * @param {Event} event - The mousedown event.
   * @returns {void}
   */
  @HostListener(&#x27;mousedown&#x27;, [&#x27;$event&#x27;])
  private onStart(event) {


    //get dimis based on zoom.
    let dims &#x3D;{
      w: this.warpSystemsCanvas.width / this.weave.warps,
      h: this.weftSystemsCanvas.height / this.render.visibleRows.length
    }


    if (event.target.localName &#x3D;&#x3D;&#x3D; &#x27;canvas&#x27;) {
    
      this.removeSubscription();    
      
      this.moveSubscription &#x3D; 
        fromEvent(event.target, &#x27;mousemove&#x27;).subscribe(e &#x3D;&gt; this.onMove(e));   

      // set up the Point to be used.
      var screen_row &#x3D; Math.floor(event.offsetY / dims.h);

      const currentPos: Interlacement &#x3D; {
        si: screen_row,
        i: screen_row, //row
        j: Math.floor((event.offsetX) / dims.w), //col
      };


      if(!event.target) return;

      //reject out of bounds requests
      switch(event.target.id){
        case &#x27;drawdown&#x27;:
          currentPos.si -&#x3D;1;
          currentPos.i -&#x3D;1;
          currentPos.j -&#x3D;1;
          if(currentPos.i &lt; 0 || currentPos.i &gt;&#x3D; this.render.visibleRows.length) return;
          if(currentPos.j &lt; 0 || currentPos.j &gt;&#x3D; this.weave.warps) return;    
          break;

        case &#x27;threading&#x27;:
          if(currentPos.i &lt; 0 || currentPos.i &gt;&#x3D; this.loom.num_frames) return;
          if(currentPos.j &lt; 0 || currentPos.j &gt;&#x3D; this.weave.warps) return;    
          break; 

        case &#x27;treadling&#x27;:
          if(currentPos.i &lt; 0 || currentPos.i &gt;&#x3D; this.render.visibleRows.length) return;
          if(currentPos.j &lt; 0 || currentPos.j &gt;&#x3D; this.loom.num_treadles) return;    
          break;

        case &#x27;tieups&#x27;:
          if(currentPos.i &lt; 0 || currentPos.i &gt;&#x3D; this.loom.num_frames) return;
          if(currentPos.j &lt; 0 || currentPos.j &gt;&#x3D; this.loom.num_treadles) return;    
        break;

        case &#x27;warp-materials&#x27;:
        case &#x27;warp-systems&#x27;:
          if(currentPos.j &lt; 0 || currentPos.j &gt;&#x3D; this.weave.warps) return;    
          break;

        case &#x27;weft-materials&#x27;:
        case &#x27;weft-systems&#x27;:
          if(currentPos.i &lt; 0 || currentPos.i &gt;&#x3D; this.render.visibleRows.length) return;
          break;
      }





      // Save temp pattern
      this.tempPattern &#x3D; cloneDeep(this.weave.pattern);
      const selected: DesignMode &#x3D; this.dm.getSelectedDesignMode(&#x27;design_modes&#x27;);
      

      switch (selected.value) {

        case &#x27;draw&#x27;:

          switch(this.dm.getSelectedDesignMode(&#x27;draw_modes&#x27;).value){

            case &#x27;toggle&#x27;:
              this.setPosAndDraw(event.target, event.shiftKey, currentPos);
              //this.unsetSelection();
            break;
    
            case &#x27;up&#x27;:
            case &#x27;down&#x27;:
            case &#x27;unset&#x27;:
            case &#x27;material&#x27;:
              this.setPosAndDraw(event.target, event.shiftKey, currentPos);
              // this.unsetSelection();
              this.flag_recompute &#x3D; true;
    
              break;
            // case &#x27;maskpoint&#x27;:
            // case &#x27;maskerase&#x27;:
            // case&#x27;maskinvert&#x27;:
            //   this.drawOnMask(currentPos);
            //   break;
          }


        
        break;
        case &#x27;select&#x27;:
        case &#x27;copy&#x27;:

            if(event.shiftKey){
              this.selection.onSelectDrag(currentPos);
              this.selection.onSelectStop();
            }   
            else this.selection.onSelectStart(event.target, currentPos);

          break;
          default:
          break;
      }

      this.lastPos &#x3D; {
        si: currentPos.si,
        i: currentPos.i, //row
        j: currentPos.j //col
      };

    }
  }

  private isSame(p1: Interlacement, p2:Interlacement){
    if(p1 &#x3D;&#x3D;&#x3D; undefined || p2 &#x3D;&#x3D;&#x3D; undefined ) return false
    return (p1.i &#x3D;&#x3D; p2.i &amp;&amp; p1.j &#x3D;&#x3D;&#x3D; p2.j);

  }



  /**
   * Event called when mouse down and moved within the canvas.
   * @extends WeaveDirective
   * @param {Event} event - The mousemove event.
   * @returns {void}
   */
  private onMove(event) {

    let dims &#x3D;{
      w: this.warpSystemsCanvas.width / this.weave.warps,
      h: this.weftSystemsCanvas.height /this.render.visibleRows.length
    };    

    var offset &#x3D; this.render.getCellDims(this.dm.getSelectedDesignMode(&#x27;design_modes&#x27;).value);
  
    // set up the point based on touched square.
    var screen_row &#x3D; Math.floor((event.offsetY + offset.y) / dims.h);

    const currentPos: Interlacement &#x3D; {
      si: screen_row,
      i:  screen_row,
      j:  Math.floor((event.offsetX + offset.x) / dims.w)
    };

   


    if(event.target &amp;&amp; event.target.id&#x3D;&#x3D;&#x3D;&quot;drawdown&quot;){
      currentPos.si -&#x3D;1;
      currentPos.i -&#x3D;1;
      currentPos.j -&#x3D;1;
    }

   

    //don&#x27;t call unless you&#x27;ve moved to a new spot
    if(this.isSame(currentPos, this.lastPos)) return;

    // determine action based on brush type. invert inactive on move.
    switch (this.dm.getSelectedDesignMode(&#x27;design_modes&#x27;).value) {
      case &#x27;draw&#x27;:
        switch(this.dm.getSelectedDesignMode(&#x27;draw_modes&#x27;).value){
          case &#x27;up&#x27;:
          case &#x27;down&#x27;:
          case &#x27;unset&#x27;:
          case &#x27;material&#x27;:
          //this.unsetSelection();

          if(currentPos.i &lt; 0 || currentPos.i &gt;&#x3D; this.render.visibleRows.length) return;
          if(currentPos.j &lt; 0 || currentPos.j &gt;&#x3D; this.weave.warps) return;


          this.setPosAndDraw(event.target, event.shiftKey, currentPos);
          this.flag_recompute &#x3D; true;


        
        break;

        case &#x27;maskpoint&#x27;:
        case &#x27;maskerase&#x27;:
        case&#x27;maskinvert&#x27;:
        this.drawOnMask(currentPos);
        break;
        }

      break;
      


      case &#x27;select&#x27;:
      case &#x27;copy&#x27;:

        this.selection.onSelectDrag(currentPos);

        break;
      case &#x27;invert&#x27;:
      default:
        break;
    }

    this.lastPos &#x3D; {
        si: currentPos.si,
        i: currentPos.i, //row
        j: currentPos.j //col
      };
  }

  /**
   * Event removes subscription when touch has ended.
   * @extends WeaveDirective
   * @param {Event} event - The mouseleave or mouseup event.
   * @returns {void}
   */
  @HostListener(&#x27;mouseleave&#x27;, [&#x27;$event&#x27;])
  @HostListener(&#x27;mouseup&#x27;, [&#x27;$event&#x27;])
  private onEnd(event) {
     this.lastPos &#x3D; {
      si: -1,
      i: -1,
      j: -1
     }

     if(this.flag_history &amp;&amp; event.type &#x3D;&#x3D; &#x27;mouseup&#x27;){
        this.timeline.addHistoryState(this.weave);
        this.flag_history &#x3D; false;
      } 


     if(this.flag_recompute &amp;&amp; event.type &#x3D;&#x3D; &#x27;mouseup&#x27;){
      if(this.render.isYarnBasedView()) this.weave.computeYarnPaths(this.ms.getShuttles());
      this.flag_recompute &#x3D; false;
     }



    // remove subscription unless it is leave event with select.
    if (!(event.type &#x3D;&#x3D;&#x3D; &#x27;mouseleave&#x27; &amp;&amp; (this.dm.isSelected(&#x27;select&#x27;,&#x27;design_modes&#x27;) || this.dm.isSelected(&#x27;copy&#x27;,&#x27;design_actions&#x27;)))){
      this.removeSubscription();
      this.selection.onSelectStop();
    }

  }

  /**
   * This is emitted from the selection
   */
  onSelectionEnd(){
    if(!this.hold_copy_for_paste) this.copyArea();
  }

  /**
   * Remove the subscription from the move event.
   * @extends WeaveDirective
   * @returns {void}
   */
 private removeSubscription() {    
    if (this.moveSubscription) {
      this.moveSubscription.unsubscribe();
    }
  }

  /**
   * Creates the copied pattern. Hack for warp and weft shuttles is that it creates a 2d arrray representing the 
   * threading or treadling with &quot;true&quot; in the frame/threadle associated with that col/row. 
   * @extends WeaveDirective
   * @returns {void}
   */
  private copyArea() {


    const screen_i &#x3D; this.selection.getStartingScreenIndex();    
    const draft_j &#x3D; this.selection.getEndingIndex();
    

    var w &#x3D; this.selection.getWidth();
    var h &#x3D; this.selection.getHeight();

    this.copy &#x3D; new Pattern({name: &#x27;copy&#x27;, width: w, height: h});
    const temp_copy: Array&lt;Array&lt;boolean&gt;&gt; &#x3D; [];

    if(this.selection.getTargetId() &#x3D;&#x3D;&#x3D; &#x27;weft-systems&#x27;){
      for(var i &#x3D; 0; i &lt; h; i++){
        temp_copy.push([]);
        for(var j &#x3D; 0; j &lt; this.ss.weft_systems.length; j++){
          temp_copy[i].push(false);
        }
      }
    }else if(this.selection.getTargetId()&#x3D;&#x3D;&#x3D; &#x27;warp-systems&#x27;){
      for(var i &#x3D; 0; i &lt; this.ss.warp_systems.length; i++){
        temp_copy.push([]);
        for(var j &#x3D; 0; j &lt; w; j++){
          temp_copy[i].push(false);
        }
      }
    }else if(this.selection.getTargetId()&#x3D;&#x3D;&#x3D; &#x27;weft-materials&#x27;){
      for(var i &#x3D; 0; i &lt; h; i++){
        temp_copy.push([]);
        for(var j &#x3D; 0; j &lt; this.ms.getShuttles().length; j++){
          temp_copy[i].push(false);
        }
      }
    }else if(this.selection.getTargetId() &#x3D;&#x3D;&#x3D; &#x27;warp-materials&#x27;){
      for(var i &#x3D; 0; i &lt; this.ms.getShuttles().length; i++){
        temp_copy.push([]);
        for(var j &#x3D; 0; j &lt; w; j++){
          temp_copy[i].push(false);
        }
      }
    }else{
       for (var i &#x3D; 0; i &lt; h; i++){
        temp_copy.push([]);
        for (var j &#x3D; 0; j &lt; w; j++){
          temp_copy[i].push(false);
        }
       }
    }


    //iterate through the selection
    for (var i &#x3D; 0; i &lt; temp_copy.length; i++) {
      for(var j &#x3D; 0; j &lt; temp_copy[0].length; j++) {

        var screen_row &#x3D; screen_i + i;
        var draft_row &#x3D; this.render.visibleRows[screen_row];
        var col &#x3D; draft_j + j;

        switch(this.selection.getTargetId()){
          case &#x27;drawdown&#x27;:
            temp_copy[i][j]&#x3D; this.weave.isUp(draft_row, col);
          break;
          case &#x27;threading&#x27;:
              var frame &#x3D; this.loom.frame_mapping[screen_row];
              temp_copy[i][j]&#x3D; this.loom.isInFrame(col,frame);

          break;
          case &#x27;treadling&#x27;:
            temp_copy[i][j] &#x3D; this.loom.isInTreadle(screen_row,col);
          break;
          case &#x27;tieups&#x27;:
              var frame &#x3D; this.loom.frame_mapping[screen_row];
              temp_copy[i][j] &#x3D; this.loom.hasTieup({i: frame, j: col, si: screen_row});
          break;  
          case &#x27;warp-systems&#x27;:
            temp_copy[i][j]&#x3D; (this.weave.colSystemMapping[col] &#x3D;&#x3D; i);
          break;
          case &#x27;weft-systems&#x27;:
            temp_copy[i][j]&#x3D; (this.weave.rowSystemMapping[draft_row] &#x3D;&#x3D; j);
          break;
          case &#x27;warp-materials&#x27;:
            temp_copy[i][j]&#x3D; (this.weave.colShuttleMapping[col] &#x3D;&#x3D; i);
          break;
          case &#x27;weft-materials&#x27;:
            temp_copy[i][j]&#x3D; (this.weave.rowShuttleMapping[draft_row] &#x3D;&#x3D; j);
          break;
          default:
          break;
        }

      }
    }

    this.copy.setPattern(temp_copy);
    this.onNewSelection.emit(this.copy);



  }





  private drawWeftMaterialCell(cx, i){
        var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
        var margin &#x3D; this.render.zoom;

        const ndx: number &#x3D; this.weave.getColorIndex(i, this.render.visibleRows);
        cx.fillStyle &#x3D; this.ms.getColor(ndx);

        if(i &#x3D;&#x3D; this.weave.wefts-1) cx.fillRect(margin, (dims.h*i)+margin, dims.w, dims.h-(margin*2));
        else cx.fillRect(margin, (dims.h*i)+margin, dims.w, dims.h-(margin));
  
  }


  private drawWeftMaterials(cx, canvas){

      var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
      var margin &#x3D; this.render.zoom;
      var top &#x3D; dims.h;

      cx.clearRect(0,0, cx.canvas.width, cx.canvas.height);


      canvas.width &#x3D;  dims.w;
      canvas.height &#x3D; this.render.visibleRows.length * dims.h;

      cx.fillStyle &#x3D; &quot;white&quot;;
      cx.fillRect(0,0,canvas.width,this.render.visibleRows.length*dims.h);

      for(var i &#x3D; 0 ; i &lt; this.render.visibleRows.length; i++){
          this.drawWeftMaterialCell(cx, i);        
      }


  }

  private drawWarpMaterialCell(cx, j){


        var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
        var margin &#x3D; this.render.zoom;
       const ndx: number &#x3D; this.weave.getColorColIndex(j);
        cx.fillStyle &#x3D; this.ms.getColor(ndx);

        if(j &#x3D;&#x3D; this.weave.warps-1) cx.fillRect((dims.w*j)+margin, 0, dims.w-(margin*2), (dims.h) - margin);
        else cx.fillRect( (dims.w*j)+margin, 0, dims.w-margin, (dims.h) - margin);
  
  }


  private drawWarpMaterials(cx,canvas){

    var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
    var margin &#x3D; this.render.zoom;

    this.warpMaterialsCanvas.width &#x3D;  this.weave.warps * dims.w;
    this.warpMaterialsCanvas.height &#x3D; dims.h;

    cx.fillStyle &#x3D; &quot;white&quot;;
    cx.fillRect(0,0,canvas.width,canvas.height);
  

    for(var j &#x3D; 0; j &lt; this.weave.warps; j++){
      this.drawWarpMaterialCell(cx, j);
    } 

  }




  private drawWeftSelectorCell(cx, i){

        var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
        var margin &#x3D; this.render.zoom;

        cx.fillStyle &#x3D; &quot;#303030&quot;;
        if(i &#x3D;&#x3D; this.weave.wefts-1) cx.fillRect(margin, (dims.h*i)+margin, dims.w, dims.h-(margin*2));
        else cx.fillRect(margin, (dims.h*i)+margin, dims.w, dims.h-(margin));
         
         cx.fillStyle &#x3D; &quot;#ffffff&quot;;  
         cx.font &#x3D; &quot;10px Arial&quot;;

         const sys &#x3D; this.weave.getWeftSystemId(i, this.render.visibleRows);
         cx.fillText(this.ss.getWeftSystemCode(sys), dims.w/3, (dims.h*i)+3*dims.h/4);

  }


  private drawWeftSystems(cx, canvas){

    

      var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
      var top &#x3D; dims.h;

      cx.clearRect(0,0, cx.canvas.width, cx.canvas.height);


      canvas.width &#x3D;  dims.w;
      canvas.height &#x3D; this.render.visibleRows.length * dims.h;

      cx.fillStyle &#x3D; &quot;white&quot;;
      cx.fillRect(0,0,canvas.width,this.render.visibleRows.length*dims.h);

      for(var i &#x3D; 0 ; i &lt; this.render.visibleRows.length; i++){
          this.drawWeftSelectorCell(cx, i);        
      }


  }

  private drawWarpSelectorCell(cx, j){


        var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
        var margin &#x3D; this.render.zoom;
        cx.fillStyle &#x3D; &quot;#303030&quot;;

        if(j &#x3D;&#x3D; this.weave.warps-1) cx.fillRect((dims.w*j)+margin, 0, dims.w-(margin*2), (dims.h) - margin);
        else cx.fillRect( (dims.w*j)+margin, 0, dims.w-margin, (dims.h) - margin);
  
         cx.fillStyle &#x3D; &quot;#ffffff&quot;;  
         cx.font &#x3D; &quot;10px Arial&quot;;

         const sys &#x3D; this.weave.getWarpSystemId(j);
         cx.fillText(this.ss.getWarpSystemCode(sys),(dims.w*j)+dims.w/3, dims.w-(margin*3));


  }


  private drawWarpSystems(cx,canvas){

    var dims &#x3D; this.render.getCellDims(&quot;base&quot;);

    this.warpSystemsCanvas.width &#x3D;  this.weave.warps * dims.w;
    this.warpSystemsCanvas.height &#x3D; dims.h;

    cx.fillStyle &#x3D; &quot;white&quot;;
    cx.fillRect(0,0,canvas.width,canvas.height);
  

    for(var j &#x3D; 0; j &lt; this.weave.warps; j++){
      this.drawWarpSelectorCell(cx, j);
    } 

  }


  /**
   * Draws the grid lines onto the canvas.
   * @extends WeaveDirective
   * @returns {void}
   */
  private drawBlank(cx,canvas) {

    cx.fillStyle &#x3D; &quot;#3d3d3d&quot;;
    cx.fillRect(0,0,canvas.width,canvas.height);
   
  }

  /**
   * Draws the grid lines onto the canvas.
   * @extends WeaveDirective
   * @returns {void}
   */
  private drawGrid(cx,canvas) {
    var i,j;

    var dims &#x3D; this.render.getCellDims(&quot;base&quot;);

    if(canvas.id&#x3D;&#x3D;&#x3D; &quot;threading&quot;){
      cx.fillStyle &#x3D; &quot;white&quot;;
      cx.fillRect(0,0,canvas.width,canvas.height);
      cx.fillStyle &#x3D; &quot;#cccccc&quot;;
      cx.fillRect(0, 0, canvas.width, (this.loom.num_frames - this.loom.min_frames)*dims.h);
    }
    else if (canvas.id&#x3D;&#x3D;&#x3D; &quot;treadling&quot;){
      cx.fillStyle &#x3D; &quot;white&quot;;
      cx.fillRect(0,0,canvas.width,canvas.height);
      cx.fillStyle &#x3D; &quot;#cccccc&quot;;
      var start &#x3D; this.loom.min_treadles * dims.w;
      cx.fillRect(start, 0, canvas.width - start, canvas.height);

    }
    else if (canvas.id&#x3D;&#x3D;&#x3D; &quot;tieups&quot;){
      cx.fillStyle &#x3D; &quot;white&quot;;
      cx.fillRect(0,0,canvas.width,canvas.height);
      cx.fillStyle &#x3D; &quot;#cccccc&quot;;
      var start &#x3D; this.loom.min_treadles * dims.w;
      cx.fillRect(start, 0, canvas.width - start, canvas.height);
      cx.fillRect(0, 0, canvas.width, (this.loom.num_frames - this.loom.min_frames)*dims.h);

    }


    cx.fillStyle&#x3D;&quot;black&quot;;
    cx.lineWidth &#x3D; .5;
    cx.lineCap &#x3D; &#x27;round&#x27;;
    cx.strokeStyle &#x3D; &#x27;#000&#x27;;

    //only draw the lines if the zoom is big enough to render them well

      // draw vertical lines
      for (i &#x3D; 0; i &lt;&#x3D; canvas.width; i +&#x3D; dims.w) {
        
          if(canvas.id &#x3D;&#x3D; &#x27;drawdown&#x27;){
            if(i &gt; dims.w &amp;&amp; i &lt; canvas.width - dims.w){
            cx.beginPath();
            cx.moveTo(i, dims.h);
            cx.lineTo(i, canvas.height-dims.h);
            cx.stroke();
            }
          }else{
            cx.beginPath();
            cx.moveTo(i, 0);
            cx.lineTo(i, canvas.height);
            cx.stroke();
          }
        

      }

      // draw horizontal lines
      for (i &#x3D; 0; i &lt;&#x3D; canvas.height; i +&#x3D; dims.h) {

        if(canvas.id &#x3D;&#x3D; &quot;drawdown&quot;){
          if(i &gt; dims.h &amp;&amp; i &lt; canvas.height - dims.h){
          cx.beginPath();
          cx.moveTo(dims.w, i);
          cx.lineTo(canvas.width-dims.w, i);
          cx.stroke();
          }
        }else{
          cx.beginPath();
          cx.moveTo(0, i);
          cx.lineTo(canvas.width, i);
          cx.stroke();
        }
      }


      // reset the line dash.
      //cx.setLineDash([0]);
    
  }




  /**
   * Change shuttle of row to next in list. If there isn&#x27;t a next in list, create a new System
   * @extends WeaveComponent
   * @param {Point} the point of the interaction
   * @returns {void}
   */
  private drawOnWeftSelectors( currentPos: Interlacement ) {

    var dims &#x3D; this.render.getCellDims(&quot;base&quot;);

    var updates;

    if (!this.cx || !currentPos) { return; }

    var draft_row &#x3D; currentPos.i; //need to offset this due to canvas padding
   
    var screen_row &#x3D; currentPos.si;

    if(screen_row &lt; 0){ return; }

    var newSystem &#x3D; this.ss.getNextWeftSystem(draft_row, this.weave);

    this.weave.rowSystemMapping[draft_row] &#x3D; newSystem;

    //this.weave.updateSystemVisibility(&#x27;weft&#x27;);

    this.redraw({weft_systems: true});



  }


    /**
   * Change shuttle of row to next in list.
   * @extends WeaveComponent
   * @param {Point} the point of the interaction
   * @returns {void}
   */
  private drawOnWeftMaterials( currentPos: Interlacement ) {

    var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
    var updates;

    if (!this.cx || !currentPos) { return; }

    var draft_row &#x3D; currentPos.i; //need to offset this due to canvas padding
    var screen_row &#x3D; currentPos.si;

    if(screen_row &lt; 0){ return; }

    if(this.dm.isSelected(&#x27;material&#x27;, &#x27;draw_modes&#x27;)){
        const material_id:string &#x3D; this.dm.getSelectedDesignMode(&#x27;draw_modes&#x27;).children[0].value;
      this.weave.rowShuttleMapping[draft_row] &#x3D; parseInt(material_id);
    }else{
      const len &#x3D; this.ms.getShuttles().length;
      var shuttle_id &#x3D; this.weave.rowShuttleMapping[draft_row];
      var newShuttle &#x3D; (shuttle_id + 1) % len;
      this.weave.rowShuttleMapping[draft_row] &#x3D; newShuttle;
    }
    this.redraw({weft_materials: true, drawdown:true});

  }

  /**
   * Change column to next row in the list
   * @extends WeaveComponent
   * @param {Point} the point of the interaction
   * @returns {void}
   */
  private drawOnWarpSelectors( currentPos: Interlacement ) {

    var dims &#x3D; this.render.getCellDims(&quot;base&quot;);

    if (!this.cxWarpSystems || !currentPos) { return; }

    var col &#x3D; currentPos.j; //need to offset this due to canvas padding

    if(col &lt; 0){ return; }

    var newSystem &#x3D; this.ss.getNextWarpSystem(col, this.weave);

    this.weave.colSystemMapping[col] &#x3D; newSystem;

    //this.weave.updateSystemVisibility(&#x27;warp&#x27;);
    this.drawWarpSelectorCell(this.cxWarpSystems,(col));
    this.redraw({warp_systems: true});
  }


  /**
   * Change column to next row in the list
   * @extends WeaveComponent
   * @param {Point} the point of the interaction
   * @returns {void}
   */
  private drawOnWarpMaterials( currentPos: Interlacement ) {

    if (!this.cxWarpSystems || !currentPos) { return; }

    var col &#x3D; currentPos.j; //need to offset this due to canvas padding

    if(col &lt; 0){ return; }
    const material_mode: DesignMode &#x3D; this.dm.getDesignMode(&#x27;material&#x27;, &#x27;draw_modes&#x27;);

    if(material_mode.selected){
        const material_id:string &#x3D; material_mode.children[0].value;
        this.weave.colShuttleMapping[col] &#x3D; parseInt(material_id);
    }else{
      const len &#x3D; this.ms.getShuttles().length;
      var shuttle_id &#x3D; this.weave.colShuttleMapping[col];
      var newShuttle_id &#x3D; (shuttle_id + 1) % len;
      this.weave.colShuttleMapping[col] &#x3D; newShuttle_id;
    }

  
    this.drawWarpSelectorCell(this.cxWarpMaterials,col);
    this.redraw({warp_materials:true, drawdown:true}); //full redraw or just this column?
  }

 /**
   * Draws, inverts, or erases a single rectangle on the mask. 
   * @extends WeaveDirective
   * @param {Point} currentPos - the current position of the mouse within draft.
   * @returns {void}
   */
  private drawOnMask( currentPos: Interlacement ) {
    var updates;
    var val;

    if (!this.cx || !currentPos) { return; }

    // Set the heddles based on the brush.
    switch (this.dm.getSelectedDesignMode(&#x27;draw_modes&#x27;).value) {
      case &#x27;maskpoint&#x27;:
        val &#x3D; true;
        break;
      case &#x27;maskerase&#x27;:
        val &#x3D; false;
        break;
      case &#x27;maskinvert&#x27;:
         val &#x3D; !this.weave.isMask(currentPos.i,currentPos.j);
        break;        
      default:
        break;
    }

    this.weave.setMask(currentPos.i,currentPos.j,val);
    this.drawCell(this.cx,currentPos.si, currentPos.j, &quot;mask&quot;);
    this.redraw({mask: true});
  }





  /**
   * Called when a single point &quot;draw&quot; event is called on the
   * @param {Point} currentPos - the current position of the mouse within draft.
   * @param shift - boolean for if the shift key was being held when this operation was called
   * @returns {void}
   */

  private drawOnDrawdown( currentPos: Interlacement, shift: boolean) {

    var updates;
    var val  &#x3D; false;


    if (!this.cx || !currentPos) { return; }


    if(this.weave.hasCell(currentPos.i, currentPos.j)){

      // Set the heddles based on the brush.
      switch (this.dm.getSelectedDesignMode(&#x27;draw_modes&#x27;).value) {
        case &#x27;up&#x27;:
          val &#x3D; true;
          this.weave.setHeddle(currentPos.i,currentPos.j,val);
          break;
        case &#x27;down&#x27;:
          val &#x3D; false;
          this.weave.setHeddle(currentPos.i,currentPos.j,val);
          break;
        case &#x27;toggle&#x27;:
          if(shift){
            val &#x3D; null;
          } 
          else val &#x3D; !this.weave.isUp(currentPos.i,currentPos.j);
          this.weave.setHeddle(currentPos.i,currentPos.j,val);

          break;

        case &#x27;unset&#x27;:
            this.weave.setHeddle(currentPos.i,currentPos.j,null);
 
        break;
        case &#x27;material&#x27;:
          this.drawOnWeftMaterials(currentPos);
          this.drawOnWarpMaterials(currentPos)
        break;        
        default:
          break;
      }


      // if(this.render.getCurrentView() &#x3D;&#x3D; &#x27;pattern&#x27;){
      //   this.drawCell(this.cx,currentPos.si, currentPos.j, &quot;drawdown&quot;);
      // }else{
      //   this.drawYarn(currentPos.si, currentPos.j, val);
      // }

      if(!this.dm.isSelected(&#x27;material&#x27;, &#x27;draw_modes&#x27;))   
        if(this.loom.isFrame()) this.loom.updateLoomFromDraft(currentPos, this.weave);
      
      this.redraw({drawdown:true, loom:true});
      
    }
    
  }

  /**
   * Draws or erases a single rectangle on the canvas. Updates the tieups.
   * @extends WeaveDirective
   * @param {Point} currentPos - the current position of the mouse within draft.
   * @returns {void}
   */
  private drawOnTieups( currentPos: Interlacement ) {
    var updates;
    var val &#x3D; false;
    
    if (!this.cxTieups || !currentPos) { return; }

    if (this.loom.inTieupRange(currentPos)) {
      switch (this.dm.getSelectedDesignMode(&#x27;draw_modes&#x27;).value) {
        case &#x27;up&#x27;:
            val &#x3D; true;
          break;
        case &#x27;down&#x27;:
          val &#x3D; false;
          break;
        case &#x27;toggle&#x27;:
          val &#x3D; !this.loom.tieup[currentPos.i][currentPos.j];
          break;
        default:
          break;
      }
    
    updates &#x3D; this.loom.updateTieup({i:currentPos.i,j: currentPos.j, val:val});
    this.weave.updateDraftFromTieup(updates, this.loom);
    this.redraw({drawdown:true, loom:true});
    
    
    }
  }

  /**
   * Draws or erases a single rectangle on the canvas. Updates the threading.
   * @extends WeaveDirective
   * @param {Point} currentPos - the current position of the mouse within draft.
   * @returns {void}
   */
  private drawOnThreading( currentPos: Interlacement ) {


    if (!this.cxThreading || !currentPos) { return; }
    

    if (this.loom.inThreadingRange(currentPos)){
      var val &#x3D; false;

      switch (this.dm.getSelectedDesignMode(&#x27;draw_modes&#x27;).value) {
        case &#x27;up&#x27;:
          val &#x3D; true;
          break;
        case &#x27;down&#x27;:
          val &#x3D; false;
          break;
        case &#x27;toggle&#x27;:
          val &#x3D; !(this.loom.threading[currentPos.j] &#x3D;&#x3D; currentPos.i);
          break;
        default:
          break;
      }

  
      const updates &#x3D; this.loom.updateThreading({i:currentPos.i, j:currentPos.j, val:val});
      this.weave.updateDraftFromThreading(updates, this.loom);

      if(this.loom.min_frames &lt; this.loom.num_frames){
        this.loom.updateUnused(this.loom.threading, this.loom.min_frames, this.loom.num_frames, &quot;threading&quot;)
      }  

      this.redraw({drawdown:true, loom:true});

      //temporarily disabled, as it causes errors, for now, just redraw the whole state
      // for(var u in updates){
      //   this.drawCell(this.cxThreading,updates[u].i, updates[u].j, &quot;threading&quot;);
      // }
          
     // if(unused) this.redrawLoom();

    }
  }


  /**
   * Draws or erases a single rectangle on the canvas. Updates the treadling.
   * @extends WeaveDirective
   * @param {Point} currentPos - the current position of the mouse within draft.
   * @returns {void}
   */
  private drawOnTreadling( currentPos: Interlacement ) {


    if (!this.cxTreadling || !currentPos) { return; }
    
    var val &#x3D; false;

    if(this.loom.inTreadlingRange(currentPos)){
      switch (this.dm.getSelectedDesignMode(&#x27;draw_modes&#x27;).value) {
        case &#x27;up&#x27;:
          val &#x3D; true;
          break;
        case &#x27;down&#x27;:
          val &#x3D; false;
          break;
        case &#x27;toggle&#x27;:
          val &#x3D; !(this.loom.treadling[currentPos.i] &#x3D;&#x3D;&#x3D; currentPos.j);
          break;
        default:
          break;
      }


      //this updates the value in the treadling
      var updates &#x3D; this.loom.updateTreadling({i:currentPos.i, j:currentPos.j, val:val});
      this.weave.updateDraftFromTreadling(updates, this.loom);

      if( this.loom.min_treadles &lt;  this.loom.num_treadles){
        this.loom.updateUnused(this.loom.treadling, this.loom.min_treadles, this.loom.num_treadles, &quot;treadling&quot;)
      }
      this.redraw({drawdown:true, loom:true});

    }
   }



  /**
   * Fills the visible regions of the mask with the stitch
   * @extends WeaveDirective
   * @param {Array&lt;Array&lt;boolean&gt;&gt;} - the pattern used to fill the area.
   * @returns {void}
   */


  private maskArea(pattern: Array&lt;Array&lt;boolean&gt;&gt;) {
   

    // var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
    // var updates &#x3D; [];

    // const rows &#x3D; pattern.length;
    // const cols &#x3D; pattern[0].length;


    // //iterate through cell
    // for (var i &#x3D; 0; i &lt; this.weave.pattern.length; i++ ) {
    //   for (var j &#x3D; 0; j &lt; this.weave.pattern[0].length; j++ ) {
        
    //     var row &#x3D; this.render.visibleRows[i];
    //     var col &#x3D; j;
    //     var temp &#x3D; pattern[i % rows][j % cols];
    //     var prev &#x3D; this.weave.mask[row][col];
    //     var val &#x3D; temp &amp;&amp; prev;

    //     var p &#x3D; new Point(); 
    //     p.i &#x3D; row;
    //     p.j &#x3D; col;
        
    //     this.weave.setHeddle(p.i,p.j,val);
    //     this.drawCell(this.cx,p.i, p.j, &quot;drawdown&quot;);
    //   }
    // }

   // this.redraw();

   }


//   //This function draws whatever the current value is at screen coordinates cell i, J
// private drawYarn(i, j, value){

//   if(this.weave.yarn_paths.length &#x3D;&#x3D; 0) return;
      
//       let p &#x3D; this.weave.yarn_paths[i][j+1];
//       let s &#x3D; this.weave.shuttles[p.getShuttle()];
//       p.setHeddle(value);

//       //check no poles

//       //no matter what, draw this cell up or down
//       if(p.isUp() &amp;&amp; this.render.isFront() || !p.isUp() &amp;&amp; !this.render.isFront()){
//           this.drawWeftUnder(i, j, s);
//         }
//         else{
//           this.drawWeftOver(i, j, s);
//       }

//   }


//This function draws whatever the current value is at screen coordinates cell i, J
  private drawCell(cx, i, j, type){


    var base_dims &#x3D; this.render.getCellDims(&quot;base&quot;);
    var base_fill &#x3D; this.render.getCellDims(&quot;base_fill&quot;);
    var has_mask &#x3D; false;
    var is_up &#x3D; false;
    var is_set &#x3D; false;
    var color &#x3D; &quot;#FFFFFF&quot;;
    var beyond &#x3D; false;

    var top &#x3D; 0; 
    var left &#x3D; 0;



    switch(type){
      case &#x27;drawdown&#x27;:
      case &#x27;mask&#x27;:
        var row &#x3D; this.render.visibleRows[i];
        
        is_up &#x3D; this.weave.isUp(row,j);
        is_set &#x3D; this.weave.isSet(row,j);

        if(!this.render.isFront()) is_up &#x3D; !is_up;
        has_mask &#x3D; this.weave.isMask(row,j);

        if(!is_set){
          color &#x3D; &quot;#cccccc&quot;;
        }
        else {
          if(is_up) color &#x3D; &quot;#333333&quot;;
           else if(has_mask) color &#x3D; &quot;#CCCCCC&quot;;
        }

        top &#x3D; base_dims.h;
        left &#x3D; base_dims.w;

      break;
      case &#x27;threading&#x27;:
        var frame &#x3D; this.loom.threading[j];
        is_up &#x3D; (frame &#x3D;&#x3D; i);
        beyond &#x3D; frame &gt; this.loom.min_frames; 
        has_mask &#x3D; false;
        
        if(is_up)  color &#x3D; &quot;#333333&quot;;
        i &#x3D; this.loom.frame_mapping[frame];

      break;
      case &#x27;tieup&#x27;:
        is_up &#x3D; (this.loom.tieup[i][j]);
        beyond &#x3D; i &gt; this.loom.min_frames; 
        has_mask &#x3D; false;
        if(is_up) color &#x3D; &quot;#333333&quot;;
        i &#x3D; this.loom.frame_mapping[i];

      break;
      case &#x27;treadling&#x27;:
        //i and j is going to come from the UI which is only showing visible rows
        var row &#x3D; this.render.visibleRows[i];
        beyond &#x3D; this.loom.treadling[row] &gt; this.loom.min_treadles; 
        is_up &#x3D; (this.loom.treadling[row] &#x3D;&#x3D; j);
        has_mask &#x3D; false;
        if(is_up)  color &#x3D; &quot;#333333&quot;;

      break;

    }

     //cx.fillStyle &#x3D; color;
     cx.fillStyle &#x3D; color;
     if(color !&#x3D; &#x27;#FFFFFF&#x27;) cx.fillRect(left+j*base_dims.w + base_fill.x, top+i*base_dims.h + base_fill.y, base_fill.w, base_fill.h);


  }

  /**This view renders cells based on the relationships with their neighbords */
  drawCrossingCell(cx, i, i_next, j, type){
    var base_dims &#x3D; this.render.getCellDims(&quot;base&quot;);
    var base_fill &#x3D; this.render.getCellDims(&quot;base_fill&quot;);
    var top &#x3D; 0; 
    var left &#x3D; 0;

    var right_edge: boolean;
    var right_bot_to_top: boolean;
    var bottom_edge: boolean;
    var bottom_bot_to_top: boolean;


    right_edge &#x3D; (this.weave.isUp(i, j) !&#x3D;&#x3D; this.weave.isUp(i, j+1)) ? true : false;

    if(right_edge){
      right_bot_to_top &#x3D; (this.weave.isUp(i, j) &amp;&amp; !this.weave.isUp(i, j+1)) ? true : false;
    }


    bottom_edge &#x3D; (this.weave.isUp(i, j) !&#x3D;&#x3D; this.weave.isUp(i_next, j)) ? true : false;
    if(bottom_edge){
      bottom_bot_to_top &#x3D; (this.weave.isUp(i, j) &amp;&amp; !this.weave.isUp(i_next, j)) ? true : false;
    }

    j++;
    i++;
    
    if(right_edge){
      cx.strokeStyle &#x3D; (right_bot_to_top) ? &quot;#FF0000&quot; : &quot;#00FF00&quot;;
      cx.beginPath();
      cx.moveTo(left+j*base_dims.w + base_fill.w , top+i*base_dims.h);
      cx.lineTo(left+j*base_dims.w + base_fill.w , top+i*base_dims.h + base_fill.h);
      cx.stroke();
    }

    if(bottom_edge){
      cx.strokeStyle &#x3D; (bottom_bot_to_top) ? &quot;#0000FF&quot; : &quot;#FFA500&quot;;
      cx.beginPath();
      cx.moveTo(left+j*base_dims.w , top+i*base_dims.h + base_fill.h);
      cx.lineTo(left+j*base_dims.w+ base_fill.w, top+i*base_dims.h + base_fill.h);
      cx.stroke();
    }
  }

  /**
   * Redraws one row to avoid drawing the entire canvas.
   * @extends WeaveDirective
   * @returns {void}
   */
  private redrawRow(y, i, cx) {
 
    for (var j &#x3D; 0; j &lt; this.weave.warps; j++) {
      this.drawCell(this.cx, i, j, &quot;drawdown&quot;);
    }
  }

  //   /**
  //  * Redraws one row to avoid drawing the entire canvas.
  //  * @extends WeaveDirective
  //  * @returns {void}
  //  */
  private redrawCol(x, i,cx) {
  }



  /**
   * 
   * @param top  the index of this weft row
   * @param shuttle the shuttle assigned to this row
   */
  public drawWeft(top:number, shuttle:Shuttle){
    var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
    var cx &#x3D; this.cx;
    var view &#x3D; this.render.getCurrentView();


    const left &#x3D; 0;
    top &#x3D;  (top + 1) * dims.h;

    top +&#x3D; dims.h/2;


    cx.lineWidth &#x3D; shuttle.getThickness()/100 * .9*dims.h;
    cx.strokeStyle &#x3D; (view &#x3D;&#x3D;&#x3D; &quot;yarn&quot; &amp;&amp; shuttle.type &#x3D;&#x3D;&#x3D; 0) ? shuttle.getColor()+&quot;10&quot; : shuttle.getColor();
    cx.shadowColor &#x3D; &#x27;white&#x27;;
    cx.shadowOffsetX &#x3D; .5;
    cx.shadowOffsetY &#x3D; 0;

    cx.beginPath();
    cx.moveTo(left+dims.w/2,top+dims.h/2);
    cx.lineTo(left+this.weave.warps * dims.w,top+dims.h/2);
    cx.stroke();
  }


  public drawWeftLeftUp(top, left, shuttle){
      var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
      var cx &#x3D; this.cx;
      var view &#x3D; this.render.getCurrentView();

      if(left &lt; -1 || left &gt; this.weave.warps) return;

      left &#x3D; (left+1)*dims.w;
      top &#x3D;  (top + 1) * dims.h;

      top +&#x3D; dims.h/2;


      cx.lineWidth &#x3D; shuttle.getThickness()/100 * .9*dims.h;
      cx.strokeStyle &#x3D; (view &#x3D;&#x3D;&#x3D; &quot;yarn&quot; &amp;&amp; shuttle.type &#x3D;&#x3D;&#x3D; 0) ? shuttle.getColor()+&quot;10&quot; : shuttle.getColor();
      cx.shadowColor &#x3D; &#x27;white&#x27;;
      cx.shadowOffsetX &#x3D; 0;
      cx.shadowOffsetY &#x3D; .5;

      cx.beginPath();
      cx.moveTo(left,top);
      cx.arcTo(left+dims.w/2, top, left+dims.w/2, top - dims.h/2, dims.w/2);
      cx.stroke();
  }

  public drawWeftRightUp(top, left, shuttle){
      var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
      var cx &#x3D; this.cx;
      var view &#x3D; this.render.getCurrentView();

      if(left &lt; -1 || left &gt; this.weave.warps) return;

      left &#x3D; (left+1)*dims.w;
      top &#x3D;  (top + 1) * dims.h;

      top +&#x3D; dims.h/2;


      cx.lineWidth &#x3D; shuttle.getThickness()/100 * .9*dims.h;
      cx.strokeStyle &#x3D; (view &#x3D;&#x3D;&#x3D; &quot;yarn&quot; &amp;&amp; shuttle.type &#x3D;&#x3D;&#x3D; 0) ? shuttle.getColor()+&quot;10&quot; : shuttle.getColor();
      cx.shadowColor &#x3D; &#x27;white&#x27;;
      cx.shadowOffsetX &#x3D; 0;
      cx.shadowOffsetY &#x3D; .5;

      cx.beginPath();
      cx.moveTo(left+dims.w,top);
      cx.arcTo(left+dims.w/2, top, left+dims.w/2, top-dims.h/2, dims.w/2);
      cx.stroke();
  }

  public drawWeftBottomLeft(top, left, shuttle){
      var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
      var cx &#x3D; this.cx;
      var view &#x3D; this.render.getCurrentView();

      if(left &lt; -1 || left &gt; this.weave.warps) return;

      left &#x3D; (left+1)*dims.w;
      top &#x3D;  (top + 1) * dims.h;

      top +&#x3D; dims.h/2;


      cx.lineWidth &#x3D; shuttle.getThickness()/100 * .9*dims.h;
      cx.strokeStyle &#x3D; (view &#x3D;&#x3D;&#x3D; &quot;yarn&quot; &amp;&amp; shuttle.type &#x3D;&#x3D;&#x3D; 0) ? shuttle.getColor()+&quot;10&quot; : shuttle.getColor();
      cx.shadowColor &#x3D; &#x27;white&#x27;;
      cx.shadowOffsetX &#x3D; .5;
      cx.shadowOffsetY &#x3D; 0;

      cx.beginPath();
      cx.moveTo(left+dims.w/2,top+dims.h/2);
      cx.arcTo(left+dims.w/2, top, left, top, dims.w/2);
      cx.stroke();
  }

  public drawWeftBottomRight(top, left, shuttle){
      var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
      var cx &#x3D; this.cx;
      var view &#x3D; this.render.getCurrentView();

      if(left &lt; -1 || left &gt; this.weave.warps) return;

      left &#x3D; (left+1)*dims.w;
      top &#x3D;  (top + 1) * dims.h;

      top +&#x3D; dims.h/2;


      cx.lineWidth &#x3D; shuttle.getThickness()/100 * .9*dims.h;
      cx.strokeStyle &#x3D; (view &#x3D;&#x3D;&#x3D; &quot;yarn&quot; &amp;&amp; shuttle.type &#x3D;&#x3D;&#x3D; 0) ? shuttle.getColor()+&quot;10&quot; : shuttle.getColor();
      cx.shadowColor &#x3D; &#x27;white&#x27;;
      cx.shadowOffsetX &#x3D; .5;
      cx.shadowOffsetY &#x3D; 0;

      cx.beginPath();
      cx.moveTo(left+dims.w/2,top+dims.h/2);
      cx.arcTo(left+dims.w/2, top, left+dims.w, top, dims.w/2);
              cx.stroke();
  }


  public drawWeftUp(top, left, shuttle){
      var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
      var cx &#x3D; this.cx;
      var view &#x3D; this.render.getCurrentView();

      if(left &lt; -1 || left &gt; this.weave.warps) return;

      left &#x3D; (left+1)*dims.w;
      top &#x3D;  (top + 1) * dims.h;

      left +&#x3D; dims.w/2

      var width &#x3D; shuttle.getThickness()/100 * .9*dims.w;
      cx.strokeStyle &#x3D; (view &#x3D;&#x3D;&#x3D; &quot;yarn&quot; &amp;&amp; shuttle.type &#x3D;&#x3D;&#x3D; 0) ? shuttle.getColor()+&quot;10&quot; : shuttle.getColor()
      cx.lineWidth &#x3D; width;
      cx.shadowColor &#x3D; &#x27;white&#x27;;
      cx.shadowOffsetX &#x3D; .5;
      cx.shadowOffsetY &#x3D; 0;

      cx.beginPath();
      cx.moveTo(left, top);
      cx.lineTo(left, top+dims.h);
      cx.stroke();

  }

  public drawWeftStart(top, left, shuttle){
      var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
      var cx &#x3D; this.cx;
      var view &#x3D; this.render.getCurrentView();

      if(left &lt; -1 || left &gt; this.weave.warps) return;

      left &#x3D; (left+1)*dims.w;
      top &#x3D;  (top + 1) * dims.h;


      top +&#x3D; dims.h/2;


      cx.lineWidth &#x3D; shuttle.getThickness()/100 * .9*dims.h;
      cx.strokeStyle &#x3D; (view &#x3D;&#x3D;&#x3D; &quot;yarn&quot; &amp;&amp; shuttle.type &#x3D;&#x3D;&#x3D; 0) ? shuttle.getColor()+&quot;10&quot; : shuttle.getColor();
      cx.fillStyle &#x3D; (view &#x3D;&#x3D;&#x3D; &quot;yarn&quot; &amp;&amp; shuttle.type &#x3D;&#x3D;&#x3D; 0) ? shuttle.getColor()+&quot;10&quot; : shuttle.getColor();


      cx.beginPath();
      var circle &#x3D; new Path2D();
      circle.arc(left+dims.w/2, top, dims.h/2, 0, 2 * Math.PI);
      cx.fill(circle);


}

public drawWeftEnd(top, left, shuttle){
      var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
      var cx &#x3D; this.cx;
      var view &#x3D; this.render.getCurrentView();

      if(left &lt; -1 || left &gt; this.weave.warps) return;

      left &#x3D; (left+1)*dims.w;
      top &#x3D;  (top + 1) * dims.h;


      top +&#x3D; dims.h/2;


      cx.lineWidth &#x3D; 1;
      cx.strokeStyle &#x3D; (view &#x3D;&#x3D;&#x3D; &quot;yarn&quot; &amp;&amp; shuttle.type &#x3D;&#x3D;&#x3D; 0) ? shuttle.getColor()+&quot;10&quot; : shuttle.getColor();
      cx.fillStyle &#x3D; (view &#x3D;&#x3D;&#x3D; &quot;yarn&quot; &amp;&amp; shuttle.type &#x3D;&#x3D;&#x3D; 0) ? shuttle.getColor()+&quot;10&quot; : shuttle.getColor();

      cx.beginPath();
      var circle &#x3D; new Path2D();
      circle.arc(left+dims.w/2, top, dims.h/2, 0, 2 * Math.PI);
      cx.stroke(circle);


}

 //break down all cells into the various kinds of drawings
  public drawWeftOver(top, left, shuttle){
      var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
      var cx &#x3D; this.cx;
      var view &#x3D; this.render.getCurrentView();

      if(left &lt; -1 || left &gt; this.weave.warps) return;

      left &#x3D; (left+1)*dims.w;
      top &#x3D;  (top + 1) * dims.h;

      top +&#x3D; dims.h/2;


      cx.lineWidth &#x3D; shuttle.getThickness()/100 * .9*dims.h;
      cx.strokeStyle &#x3D; (view &#x3D;&#x3D;&#x3D; &quot;yarn&quot; &amp;&amp; shuttle.type &#x3D;&#x3D;&#x3D; 0) ? shuttle.getColor()+&quot;10&quot; : shuttle.getColor();
      cx.shadowColor &#x3D; &#x27;white&#x27;;
      cx.shadowOffsetX &#x3D; 0;
      cx.shadowOffsetY &#x3D; .5;

      cx.beginPath();
      cx.moveTo(left, top);
      cx.lineTo(left+dims.w, top);
      cx.stroke();

  }

   //break down all cells into the various kinds of drawings
  public drawWeftUnder(top, left, shuttle){
      var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
      var warp_shuttle &#x3D; this.ms.getShuttle(this.weave.colShuttleMapping[left]);
      var cx &#x3D; this.cx;
      var view &#x3D; this.render.getCurrentView();

      if(left &lt; -1 || left &gt; this.weave.warps) return;

      left &#x3D; (left+1)*dims.w;
      top &#x3D;  (top + 1) * dims.h;

      top +&#x3D; dims.h/2

      var warp_width &#x3D; warp_shuttle.getThickness()/100 * .9*dims.w;
      var stroke_width &#x3D; shuttle.getThickness()/100 * .9*dims.h;
      var margin &#x3D; (.9*dims.w - warp_width)/2;

      cx.lineWidth &#x3D; stroke_width;
      cx.strokeStyle &#x3D; (view &#x3D;&#x3D;&#x3D; &quot;yarn&quot; &amp;&amp; shuttle.type &#x3D;&#x3D;&#x3D; 0) ? shuttle.getColor()+&quot;10&quot; : shuttle.getColor();
      cx.shadowColor &#x3D; &#x27;white&#x27;;
      cx.shadowOffsetX &#x3D; 0;
      cx.shadowOffsetY &#x3D; .5;

      cx.fillStyle &#x3D; &quot;#393939&quot;;
      cx.fillRect(left, top-dims.h/2, dims.w, dims.h);

      cx.beginPath();
      cx.moveTo(left, top);
      cx.lineTo(left+margin, top);
      cx.stroke();
  
      cx.beginPath();
      cx.moveTo(left+margin+warp_width, top);
      cx.lineTo(left+dims.w, top);
      cx.stroke();
     
      cx.lineWidth &#x3D; warp_width;
      cx.strokeStyle &#x3D; (view &#x3D;&#x3D;&#x3D; &quot;yarn&quot; &amp;&amp; warp_shuttle.type &#x3D;&#x3D;&#x3D; 0) ? warp_shuttle.getColor()+&quot;10&quot; : warp_shuttle.getColor();

      cx.beginPath();
      cx.moveTo(left+dims.w/2, top-dims.h/2);
      cx.lineTo(left+dims.w/2, top+dims.h/2);
      cx.stroke();

  }

  /**
   * called on scroll
   * @param scroll_top 
   * @param scroll_left 
   */
  public reposition(scroll_top: number, scroll_left: number){

  }

  //flips the view from front to back
  public flip(){
    console.log(&#x27;flip&#x27;);
    const container: HTMLElement &#x3D; document.getElementById(&#x27;draft-scale-container&#x27;);
    container.style.transformOrigin &#x3D; &#x27;50% 50%&#x27;;
    if(this.render.view_front) container.style.transform &#x3D; &quot;matrix(1, 0, 0, 1, 0, 0) scale(&quot; + this.render.getZoom() + &#x27;)&#x27;;
    else container.style.transform &#x3D; &quot;matrix(-1, 0, 0, 1, 0, 0) scale(&quot; + this.render.getZoom() + &#x27;)&#x27;;

  }

  /**
   * this rescales the canvas and updates the view from scroll events
   * receives offset of the scroll from the CDKScrollable created when the scroll was initiated
   */
  //this does not draw on canvas but just rescales the canvas
  public rescale(zoom: number){
    console.log(&quot;rescale&quot;);

  //   //var dims &#x3D; this.render.getCellDims(&quot;base&quot;);
    const container: HTMLElement &#x3D; document.getElementById(&#x27;draft-scale-container&#x27;);
    container.style.transformOrigin &#x3D; &#x27;top center&#x27;;
    container.style.transform &#x3D; &#x27;scale(&#x27; + zoom + &#x27;)&#x27;;

   
   }


  public drawWarpsOver(){


    for (var i &#x3D; 0; i &lt; this.render.visibleRows.length ; i++) {
       
        const row_index &#x3D; this.render.visibleRows[i];
        const row_values &#x3D; this.weave.pattern[row_index];
        

        let overs &#x3D; [];
        if(this.render.isFront()){
          overs &#x3D; row_values.reduce((overs, v, idx) &#x3D;&gt; v.isUp() ? overs.concat([idx]) : overs, []);
        }else{
          overs &#x3D; row_values.reduce((overs, v, idx) &#x3D;&gt; !v.isUp() ? overs.concat([idx]) : overs, []);
        }

        for(var o in overs){
            const shuttle_id &#x3D; this.weave.colShuttleMapping[overs[o]];
            const system_id &#x3D; this.weave.colSystemMapping[overs[o]];
            if(this.ss.warp_systems[system_id].isVisible()) this.drawWeftUp(i, overs[o], this.ms.getShuttle(shuttle_id));
        }

    }


  }

  

  



  //public redrawYarnView(){

    //draw from bottom to top 


  //   //first, just draw all the wefts 
  //  const shuttles: Array&lt;number&gt; &#x3D;  this.render.visibleRows.map(el &#x3D;&gt; this.weave.rowShuttleMapping[el]);

  //  shuttles.forEach((shuttle, i) &#x3D;&gt; {
  //     this.drawWeft(i, this.ms.getShuttle(shuttle));
  //  });

  //   const crossings: Array&lt;Array&lt;Crossing&gt;&gt; &#x3D; this.weave.getRelationalDraft();
  //   const visible_crossings &#x3D; crossings.filter((el, i) &#x3D;&gt; this.render.visibleRows.find(el &#x3D;&gt; el &#x3D;&#x3D; i) !&#x3D;&#x3D; -1);

  //   visible_crossings.forEach((row, i) &#x3D;&gt;{

  //     let cur_j &#x3D; 0;
  //     let cur_state: boolean &#x3D; false;

  //     row.forEach(crossing &#x3D;&gt; {

  //       if(cur_j &lt; crossing.j){
  //         cur_state &#x3D; crossing.type.t;
  //       }

  //     });


  //   });  



    // let started:boolean &#x3D; false;

    // for(let i &#x3D; 0; i &lt; this.render.visibleRows.length; i++){

    //   let index_row &#x3D; this.render.visibleRows[i];

    //   let row_values &#x3D; this.weave.pattern[index_row];

    //   let shuttle_id &#x3D; this.weave.rowShuttleMapping[index_row];

    //   let s &#x3D; this.ms.getShuttle(shuttle_id);

    //   //iterate through the rows
    //   for(let j &#x3D; 0; j &lt; row_values.length; j++){
        
    //     let p &#x3D; row_values[j];

    //   //   if(p.isEastWest())  this.drawWeftOver(i,j,s);
    //   //   if(p.isSouthWest()) this.drawWeftBottomLeft(i,j,s);
    //   //  // if(p.isNorthSouth())this.drawWeftUp(i, j, s);
    //   //   if(p.isSouthEast()) this.drawWeftBottomRight(i,j,s);
    //   //   if(p.isNorthWest()) this.drawWeftLeftUp(i,j,s);
    //   //   if(p.isNorthEast()) this.drawWeftRightUp(i, j, s);

    //   }
    // }

  //}


  public redrawYarnView(){


    for(let i &#x3D; 0; i &lt; this.render.visibleRows.length; i++){

      let index_row &#x3D; this.render.visibleRows[i];

      let row_values &#x3D; this.weave.pattern[index_row];

      let shuttle_id &#x3D; this.weave.rowShuttleMapping[index_row];

      let s &#x3D; this.ms.getShuttle(shuttle_id);

      //iterate through the rows
      for(let j &#x3D; 0; j &lt; row_values.length; j++){
        
        let p &#x3D; row_values[j];

        if(p.isEastWest())  this.drawWeftOver(i,j,s);
        if(p.isSouthWest()) this.drawWeftBottomLeft(i,j,s);
       // if(p.isNorthSouth())this.drawWeftUp(i, j, s);
        if(p.isSouthEast()) this.drawWeftBottomRight(i,j,s);
        if(p.isNorthWest()) this.drawWeftLeftUp(i,j,s);
        if(p.isNorthEast()) this.drawWeftRightUp(i, j, s);

      }
    }

  }

 


 //draws any updates from a change in a part of the drawdown on the threading, tieup, and treadling
 //will update height if a new row/column is added but for zoom, call redrawLoomSize
  public drawLoomStates(updates) {

    var dims &#x3D; this.render.getCellDims(&quot;base&quot;);

    //if the new value in outside of the visible range, redraw the entire loom
    if((this.loom.num_frames)*dims.h &gt; (this.cxThreading.canvas.height)){ 
      this.redrawLoom();
      return;
    }

    for(var u in updates.threading){    
       this.drawCell( this.cxThreading, updates.threading[u].i, updates.threading[u].j, &quot;threading&quot;);
    }

   
    if((this.loom.num_treadles)*dims.w &gt; this.cxTreadling.canvas.width){ 
      this.redrawLoom();
      return;
    }

    for(var u in updates.treadling){   
      this.drawCell( this.cxTreadling, updates.treadling[u].i, updates.treadling[u].j, &quot;treadling&quot;);
    }

    for(var u in updates.tieup){
      for(var j in updates.tieup[u]){
        this.drawCell( this.cxTieups, updates.tieup[u][j].i, updates.tieup[u][j].j, &quot;tieup&quot;);
      }
    }
  }



  public redrawLoom() {


    var base_dims &#x3D; this.render.getCellDims(&quot;base&quot;);
    var front &#x3D; this.render.isFront();

    this.cxThreading.clearRect(0,0, this.cxThreading.canvas.width, this.cxThreading.canvas.height);
    this.cxTreadling.clearRect(0,0, this.cxTreadling.canvas.width, this.cxTreadling.canvas.height);
    this.cxTieups.clearRect(0,0, this.cxTieups.canvas.width, this.cxTieups.canvas.height);


    this.cxThreading.canvas.width &#x3D; base_dims.w * this.loom.threading.length;
    this.cxThreading.canvas.height &#x3D; base_dims.h * this.loom.num_frames;
    this.drawGrid(this.cxThreading,this.threadingCanvas);
   // else this.drawBlank(this.cxThreading,this.threadingCanvas);


    this.cxTreadling.canvas.width &#x3D; base_dims.w * this.loom.num_treadles;
    this.cxTreadling.canvas.height &#x3D; base_dims.h * this.render.visibleRows.length;
    this.drawGrid(this.cxTreadling,this.treadlingCanvas);
    //else this.drawBlank(this.cxTreadling,this.treadlingCanvas);

    this.cxTieups.canvas.width &#x3D; base_dims.w * this.loom.tieup[0].length;
    this.cxTieups.canvas.height &#x3D; base_dims.h * this.loom.tieup.length;
    this.drawGrid(this.cxTieups,this.tieupsCanvas);
    //else this.drawBlank(this.cxTieups,this.tieupsCanvas);
    


    for (var j &#x3D; 0; j &lt; this.loom.threading.length; j++) {
      this.drawCell(this.cxThreading, this.loom.threading[j], j, &quot;threading&quot;);
    }

    //only cycle through the visible rows
    for (var i &#x3D; 0; i &lt; this.render.visibleRows.length; i++) {
       this.drawCell(this.cxTreadling, i, this.loom.treadling[this.render.visibleRows[i]], &quot;treadling&quot;);
    }

    for (var i &#x3D; 0; i &lt; this.loom.tieup.length; i++) {
      for(var j &#x3D; 0; j &lt; this.loom.tieup[i].length; j++){
        if(this.loom.tieup[i][j]){
          this.drawCell(this.cxTieups, i, j, &quot;tieup&quot;);
        }
      }
    }

  }

//callled when frames become visible or drawdown without frame info is loaded
  public recomputeLoom(){

    this.loom.recomputeLoom(this.weave);
  }


  public unsetSelection(){
    this.selection.unsetParameters();
  }

public drawDrawdown(){
  console.log(&quot;this.render.getCurrentView&quot;, this.render.getCurrentView())

   switch(this.render.getCurrentView()){
      case &#x27;pattern&#x27;:
      this.redrawDraft();
      break;

      case &#x27;yarn&#x27;:
      this.redrawVisualView();
      break;

      case &#x27;visual&#x27;:
      this.redrawVisualView();
      break;

      case &#x27;crossing&#x27;:
      this.redrawCrossings();
      break;
    }
}

//takes inputs about what, exactly to redraw
public redraw(flags:any){

    var base_dims &#x3D; this.render.getCellDims(&quot;base&quot;);

    if(flags.drawdown !&#x3D;&#x3D; undefined){
        this.cx.clearRect(0,0, this.canvasEl.width, this.canvasEl.height);   
        this.cx.canvas.width &#x3D; base_dims.w * (this.weave.pattern[0].length+2);
        this.cx.canvas.height &#x3D; base_dims.h * (this.render.visibleRows.length+2);
        this.cx.strokeStyle &#x3D; &quot;#3d3d3d&quot;;

        if(this.source &#x3D;&#x3D; &quot;weaver&quot;) this.cx.fillStyle &#x3D; &quot;#3d3d3d&quot;;
        else this.cx.fillStyle &#x3D; &quot;#ffffff&quot;;
        this.cx.fillRect(0,0,this.canvasEl.width,this.canvasEl.height);
        this.cx.strokeRect(base_dims.w,base_dims.h,this.canvasEl.width-base_dims.w*2,this.canvasEl.height-base_dims.h*2);
        this.drawDrawdown();
    }

    if(flags.weft_systems !&#x3D;&#x3D; undefined &amp;&amp; this.source &#x3D;&#x3D; &quot;weaver&quot;){
      this.drawWeftSystems(this.cxWeftSystems, this.weftSystemsCanvas);
    }

    if(flags.weft_materials !&#x3D;&#x3D; undefined &amp;&amp; this.source &#x3D;&#x3D; &quot;weaver&quot;){
      this.drawWeftMaterials(this.cxWeftMaterials, this.weftMaterialsCanvas);
    }

    if(flags.warp_systems !&#x3D;&#x3D; undefined &amp;&amp; this.source &#x3D;&#x3D; &quot;weaver&quot;){
      this.drawWarpSystems(this.cxWarpSystems, this.warpSystemsCanvas);
    }

    if(flags.warp_materials !&#x3D;&#x3D; undefined &amp;&amp; this.source &#x3D;&#x3D; &quot;weaver&quot;){
      this.drawWarpMaterials(this.cxWarpMaterials, this.warpMaterialsCanvas);
    }

    if(flags.loom !&#x3D;&#x3D; undefined &amp;&amp; this.loom.isFrame()){
       this.redrawLoom();
    }

  }
  

  /**
   * Redraws the entire canvas based on weave pattern.
   * @extends WeaveDirective
   * @returns {void}
   */
  public redrawDraft() {
    
    var base_dims &#x3D; this.render.getCellDims(&quot;base&quot;);
    this.cx.fillStyle &#x3D; &quot;white&quot;;
    this.cx.fillRect(base_dims.w,base_dims.h,this.canvasEl.width - base_dims.w*2,this.canvasEl.height-base_dims.h*2);

    var i,j;

    

    var color &#x3D; &#x27;#000000&#x27;;
    this.cx.fillStyle &#x3D; color;
    for (i &#x3D; 0; i &lt; this.render.visibleRows.length; i++) {
      this.redrawRow(i * base_dims.h, i, this.cx);
    }


     for (var x &#x3D; 0; x &lt; this.weave.colShuttleMapping.length; x++) {
     
      let system;

      var id &#x3D; this.weave.colShuttleMapping[x];
      if(id &#x3D;&#x3D;&#x3D; undefined) system &#x3D; this.ss.getFirstWarpSystem();
      else system &#x3D; this.ss.getWarpSystem(id);
      var shuttle &#x3D; this.ms.getShuttle(id);



        if(!system.visible){
          var c &#x3D; &quot;#3d3d3d&quot;;
          var t &#x3D; 100;

          var width &#x3D; base_dims.w;
          var w_margin &#x3D; base_dims.w;
          this.cx.fillStyle &#x3D; c;
          this.cx.fillRect(x*base_dims.w+w_margin, 0, width, base_dims.h*this.render.visibleRows.length);

        }
    }   

    this.drawGrid(this.cx,this.canvasEl);

  }






  public drawWarps(cx){
    //draw all the warps

    var base_dims &#x3D; this.render.getCellDims(&quot;base&quot;);
    var schematic &#x3D; (this.render.getCurrentView() &#x3D;&#x3D;&#x3D; &quot;yarn&quot;);
    for (var x &#x3D; 0; x &lt; this.weave.colShuttleMapping.length; x++) {
     
      let system;
      var id &#x3D; this.weave.colShuttleMapping[x];
      if(id &#x3D;&#x3D;&#x3D; undefined) system &#x3D; this.ss.getFirstWarpSystem();
      else system &#x3D; this.ss.getWarpSystem(id);

      var shuttle &#x3D; this.ms.getShuttle(id);

      if(system.visible){
          var c &#x3D; shuttle.getColor();
          var t &#x3D; shuttle.getThickness();
          var center &#x3D; base_dims.w/2;


          cx.lineWidth &#x3D; t/100 * .9*base_dims.w;
          cx.strokeStyle &#x3D; (shuttle.type &gt; 0 || !schematic) ? c : c+&quot;10&quot;;
          cx.shadowColor &#x3D; &#x27;white&#x27;;
          cx.shadowOffsetX &#x3D; 0.5;
          cx.shadowOffsetY &#x3D; 0;

          cx.beginPath();
          cx.moveTo((x+1)*base_dims.w + center, 0);
          cx.lineTo((x+1)*base_dims.w + center, base_dims.h*(this.render.visibleRows.length+2));
          cx.stroke();

      }
    }
  }


 /**
   * Highlights intersections between yarns, when they cross from front to back
   * @extends WeaveDirective
   * @returns {void}
   */
  public redrawCrossings() {

    console.log(&#x27;redraw crossings&#x27;)

    var base_dims &#x3D; this.render.getCellDims(&quot;base&quot;);
    this.cx.fillStyle &#x3D; &quot;white&quot;;
    this.cx.fillRect(base_dims.w,base_dims.h,this.canvasEl.width - base_dims.w*2,this.canvasEl.height-base_dims.h*2);

    var i,j;

    var color &#x3D; &#x27;#000000&#x27;;
    this.cx.fillStyle &#x3D; color;
    for (i &#x3D; 0; i &lt; this.render.visibleRows.length; i++) {
      for(j &#x3D; 0; j &lt; this.weave.warps; j ++){
        this.drawCrossingCell(this.cx, this.render.visibleRows[i], this.render.getNextVisibleRow(i), j, &#x27;crossings&#x27;);
      }
    }
  }


  /**
   * Simulates the visual look of the weave pattern.
   * @extends WeaveDirective
   * @returns {void}
   */
  public redrawVisualView() {

    console.log(&quot;drawing visual view&quot;);

    this.weave.computeYarnPaths(this.ms.getShuttles());

    this.cx.fillStyle &#x3D; &quot;#3d3d3d&quot;;
    this.cx.fillRect(0,0,this.canvasEl.width,this.canvasEl.height);

    this.drawWarps(this.cx);
    
    this.redrawYarnView();

    if(this.render.getCurrentView() &#x3D;&#x3D;&#x3D; &#x27;visual&#x27;){
      this.drawWarpsOver();
    }

    this.cx.strokeStyle &#x3D; &quot;#000&quot;;
    this.cx.fillStyle &#x3D; &quot;#000&quot;;
  }

  public onUndoRedo() {

  }

  /**
   * Prints the pattern to the console.
   * @extends WeaveDirective
   * @param {Array&lt;Array&lt;boolean&gt;&gt;} pattern - 2D pattern array.
   * @returns {void}
   */
  public printPattern(pattern) {
    for (var i &#x3D; 0; i &lt; pattern.length; i++) {
      var s &#x3D; &quot;&quot;;
      for (var j &#x3D; 0; j &lt; pattern[0].length; j++) {
        if (pattern[i][j]) {
          s +&#x3D; &#x27;x&#x27;;
        } else {
          s +&#x3D; &#x27;o&#x27;
        }
      }
      console.log(s);
    }
  }


   /**
   * Saves the draft as a bitmap file
   * @extends WeaveDirective
   * @param {string} fileName - name to save file as
   * @returns {void}
   */
  public getPrintableCanvas(obj) : HTMLCanvasElement {


    let dims &#x3D; this.render.getCellDims(&quot;base&quot;);

    let b &#x3D; obj.bitmap.nativeElement;
    let context &#x3D; b.getContext(&#x27;2d&#x27;);

    b.width &#x3D; (this.weave.warps + this.loom.num_treadles + 6) * dims.w;
    b.height &#x3D; (this.weave.wefts + this.loom.num_frames + 6) * dims.h;
    
    context.fillStyle &#x3D; &quot;white&quot;;
    context.fillRect(0,0,b.width,b.height);
    
    //use this to solve 0 width errors on drawIMage
    if(this.loom.isFrame()){

      context.drawImage(this.threadingCanvas, 0, dims.h*3);
      context.drawImage(this.tieupsCanvas, (this.weave.warps +1)* dims.w, 3*dims.h);
      context.drawImage(this.treadlingCanvas, (this.weave.warps +1)* dims.w, (this.loom.num_frames + 4)*dims.h);

    }

    //systems
    context.drawImage(this.warpSystemsCanvas, 0, 0);
    context.drawImage(this.warpMaterialsCanvas, 0, dims.h);

    context.drawImage(this.canvasEl, -dims.w, (this.loom.num_frames+3)*dims.h);
   
    context.drawImage(this.weftMaterialsCanvas,(this.weave.warps+ this.loom.num_treadles +1)* dims.w, (this.loom.num_frames + 4)*dims.h);
    context.drawImage(this.weftSystemsCanvas,(this.weave.warps+ this.loom.num_treadles +2)* dims.w, (this.loom.num_frames + 4)*dims.h);
    return b;
  }

  /**
   * Saves the draft as a bitmap file
   * @extends WeaveDirective
   * @param {string} fileName - name to save file as
   * @returns {void}
   */
  public getBMPCanvas(obj) : HTMLCanvasElement {
    let b &#x3D; obj.bitmap.nativeElement;
    let context &#x3D; b.getContext(&#x27;2d&#x27;);
    let draft &#x3D; this.weave.pattern;
    var i,j;

    b.width &#x3D; this.weave.warps;
    b.height &#x3D; this.weave.wefts;
    context.fillStyle &#x3D; &quot;white&quot;;
    context.fillRect(0,0,b.width,b.height);

    context.fillStyle &#x3D; &quot;black&quot;;

    for( i &#x3D; 0; i &lt; b.height; i++) {
      for( j&#x3D;0; j &lt; b.width; j++) {
        let up &#x3D; draft[i][j].isUp();
        if(up) {
          context.fillRect(j,i,1,1)
        }
      }
    }
    return b;
  }

   /**
   *
   *
   */
    // public onSave(e: any) {

    //   e.bitmap &#x3D; this.bitmap;
  
    //   if (e.type &#x3D;&#x3D;&#x3D; &quot;bmp&quot;){
    //     let link &#x3D; e.downloadLink.nativeElement;
    //     link.href &#x3D; this.fs.saver.bmp(this.getBMPCanvas(e));
    //     link.download &#x3D; e.name + &quot;.jpg&quot;; //Canvas2Bitmap  seems to be broken now
    //   } 
    //   else if (e.type &#x3D;&#x3D;&#x3D; &quot;ada&quot;){
    //     let link &#x3D; e.downloadLink.nativeElement;
    //     link.href &#x3D; this.fs.saver.ada(&#x27;draft&#x27;, [this.weave], [this.loom],  false, 5);
    //     link.download &#x3D; e.name + &quot;.ada&quot;;
    //   } 
    //   else if (e.type &#x3D;&#x3D;&#x3D; &quot;wif&quot;){
    //     let link &#x3D; e.downloadLink.nativeElement;
    //     link.href&#x3D; this.fs.saver.wif(this.weave, this.loom);
    //     link.download &#x3D; e.filename +&quot;.wif&quot;;
  
    //   } 
    //   else if (e.type &#x3D;&#x3D;&#x3D; &quot;jpg&quot;){
    //     let link &#x3D; e.downloadLink.nativeElement;
    //     link.href &#x3D; this.fs.saver.jpg(this.getPrintableCanvas(e));
    //     link.download &#x3D; e.name + &quot;.jpg&quot;;
    //   } 
      
    // }

    /**
   * inserts an empty row just below the clicked row
   * @param si the screen index of the row we&#x27;ll insert
   * @param i the absolute (not screen) index of the row we&#x27;ll insert
   */
  public insertRow(si:number, i:number) {

    const shuttle: number &#x3D; this.weave.rowToShuttle(this.render.visibleRows, si);
    const system: number &#x3D; this.weave.rowToSystem(this.render.visibleRows, si);

    this.weave.insertRow(i, shuttle, system);
    this.loom.insertRow(i);
    this.render.updateVisible(this.weave);
    this.redraw({drawdown: true, loom:true, weft_systems: true, weft_materials:true});
    this.timeline.addHistoryState(this.weave);

  }
    /**
   * clones the selected row and pastes into next visible row
   * @param si the screen index of the row we&#x27;ll insert
   * @param i the absolute (not screen) index of the row we&#x27;ll insert
   */
  public cloneRow(si: number, i:number) {

    const shuttle: number &#x3D; this.weave.rowToShuttle(this.render.visibleRows, si);
    const system: number &#x3D; this.weave.rowToSystem(this.render.visibleRows, si);
    this.weave.cloneRow(i, shuttle, system);
    this.loom.cloneRow(i);
  

    this.render.updateVisible(this.weave);
    this.redraw({drawdown: true, loom:true, weft_systems: true, weft_materials:true});
    this.timeline.addHistoryState(this.weave);

  }

  public deleteRow(i) {
    this.weave.deleteRow(i);
    this.loom.deleteRow(i);
    this.render.updateVisible(this.weave);
    this.redraw({drawdown: true, loom:true, weft_systems: true, weft_materials:true});
    this.timeline.addHistoryState(this.weave);
  }

    /**
   * In
   * @extends WeaveComponent
   * @returns {void}
   */
  public insertCol(i, shuttle,system) {


    //flip the index based on the flipped view
    i &#x3D; (this.weave.warps + 1) - i;
    

    this.weave.insertCol(i, shuttle,system);
    this.loom.insertCol(i);
    this.redraw({drawdown: true, loom:true, warp_systems: true, warp_materials:true});
    this.weave.computeYarnPaths(this.ms.getShuttles());
    this.timeline.addHistoryState(this.weave);

  }

  public cloneCol(i, shuttle,system) {

    i &#x3D; (this.weave.warps-1) - i;

        
    this.weave.cloneCol(i, shuttle,system);
    this.loom.cloneCol(i);
    this.redraw({drawdown: true, loom:true, warp_systems: true, warp_materials:true});
    this.weave.computeYarnPaths(this.ms.getShuttles());
    this.timeline.addHistoryState(this.weave);

  }


  public deleteCol(i) {

      //flip the index based on the flipped view
      i &#x3D; (this.weave.warps-1) - i;

    this.weave.deleteCol(i);
    this.loom.deleteCol(i);
    this.redraw({drawdown: true, loom:true, warp_systems: true, warp_materials:true});
    this.weave.computeYarnPaths(this.ms.getShuttles());
    this.timeline.addHistoryState(this.weave);
  }


  /**
   * Tell the weave directive to fill selection with pattern.
   * @extends WeaveComponent
   * @param {Event} e - fill event from design component.
   * @returns {void}
   */
   public onFill(e) {
    
    let p:Pattern &#x3D; this.ps.getPattern(e.id);
    
    this.weave.fillArea(this.selection, p, &#x27;original&#x27;, this.render.visibleRows, this.loom);

    if(this.loom.isFrame()) this.loom.recomputeLoom(this.weave);

    if(this.render.isYarnBasedView()) this.weave.computeYarnPaths(this.ms.getShuttles());
    
    this.copyArea();

    this.redraw({drawdown:true, loom:true});

    this.timeline.addHistoryState(this.weave);
    
  }

  /**
   * Tell weave reference to clear selection.
   * @extends WeaveComponent
   * @param {Event} Delte - clear event from design component.
   * @returns {void}
   */
  public onClear(b:boolean) {
    
    const p: Pattern &#x3D; new Pattern({width: 1, height: 1, pattern: [[b]]});

    this.weave.fillArea(this.selection, p, &#x27;original&#x27;, this.render.visibleRows, this.loom)

    if(this.loom.isFrame())this.loom.recomputeLoom(this.weave);

    if(this.render.isYarnBasedView()) this.weave.computeYarnPaths(this.ms.getShuttles());

    this.copyArea();

    this.redraw({drawdown:true, loom:true});

    this.timeline.addHistoryState(this.weave);

  }

  /**
   * Tells weave reference to paste copied pattern.
   * @extends WeaveComponent
   * @param {Event} e - paste event from design component.
   * @returns {void}
   */
   public onPaste(e) {

    this.hold_copy_for_paste &#x3D; false;


    var p &#x3D; this.copy;
    console.log(&quot;on paste&quot;, e, p);


    var type;

    if(e.type &#x3D;&#x3D;&#x3D; undefined) type &#x3D; &quot;original&quot;;
    else type &#x3D;  e.type;

    this.weave.fillArea(this.selection, p, type, this.render.visibleRows, this.loom);

    switch(this.selection.getTargetId()){    
      case &#x27;drawdown&#x27;:
        //if you do this when updates come from loom, it will erase those updates
        if(this.loom.isFrame()) this.loom.recomputeLoom(this.weave);
       break;
      
    }

    
    if(this.render.isYarnBasedView()) this.weave.computeYarnPaths(this.ms.getShuttles());

    this.timeline.addHistoryState(this.weave);

    this.copyArea();

    this.redraw({drawdown:true, loom:true, weft_materials: true, warp_materials:true, weft_systems:true, warp_systems:true});
 

  }

  onCopy(){
    this.copyArea();
    this.hold_copy_for_paste &#x3D; true;
  }


 





}
</code></pre>
        </div>
    </div>










                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
           </div>
       </div>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/search/search.js"></script>
       <script src="../js/search/lunr.min.js"></script>
       <script src="../js/search/search-lunr.js"></script>

       <script src="../js/menu.js"></script>
       <script src="../js/libs/highlight.pack.js"></script>
       <script src="../js/libs/highlightjs-line-numbers.min.js"></script>
       <script src="../js/search/search_index.js"></script>
       <script>
            document.addEventListener('DOMContentLoaded', function() {
                hljs.initHighlightingOnLoad();
                hljs.initLineNumbersOnLoad();
            });
       </script>

    </body>
</html>
