<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>adacad-weaver documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	    <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">adacad-weaver documentation</a>
            <button type="button" class="btn btn-default btn-menu fa fa-bars" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
            <div id="book-search-input" role="search">
                <input type="text" placeholder="Type to search">
            </div>
            <nav>
            
                <ul class="list">
            
                    <li class="title">
                        <a href="../">adacad-weaver documentation</a>
                    </li>
            
                    <li class="divider"></li>
            
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../"><span class="fa fa-home"></span>Getting started</a>
                        <ul class="links">
                                <li class="link">
                                    <a href="../" ><span class="fa fa-file-text-o"></span>README</a>
                                </li>
                                <li class="link">
                                    <a 
                                        
                                         href="../overview.html" 
                                         href="../overview.html" 
                                        >
                                        <span class="fa fa-th"></span>Overview
                                    </a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="./modules.html" >
                            <span class="fa fa-archive"></span>
                            <span>Modules</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-modules-links"
                            ></span>
                        </a>
                        <ul class="links collapse in"
                                id="xs-modules-links"
                            >
                                <li class="link">
                                    <a href="../modules/AppModule.html" >AppModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/AppRoutingModule.html" >AppRoutingModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/CoreModule.html" >CoreModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/MixerModule.html" >MixerModule</a>
                                </li>
                                <li class="link">
                                    <a href="../modules/WeaverModule.html" >WeaverModule</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-cogs"></span>
                            <span>Components</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-components-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-components-links"
                            >
                                <li class="link">
                                    <a href="../components/AboutModal.html" >AboutModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/ActionsComponent.html" >ActionsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/AppComponent.html" >AppComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/ConnectionComponent.html" >ConnectionComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/ConnectionModal.html" >ConnectionModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/DraftdetailComponent.html" >DraftdetailComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/DraftviewerComponent.html" >DraftviewerComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/ImageComponent.html" >ImageComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/InitModal.html" >InitModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/LoomComponent.html" >LoomComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/LoomModal.html" >LoomModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MaterialModal.html" >MaterialModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MaterialsComponent.html" >MaterialsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerComponent.html" >MixerComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerDesignComponent.html" >MixerDesignComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerInitComponent.html" >MixerInitComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerPatternsComponent.html" >MixerPatternsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerViewComponent.html" >MixerViewComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MixerViewComponent.html" >MixerViewComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/MlModal.html" >MlModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/NoteComponent.html" >NoteComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/NotesComponent.html" >NotesComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/OpHelpModal.html" >OpHelpModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/OperationComponent.html" >OperationComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/OpsComponent.html" >OpsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/PaletteComponent.html" >PaletteComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/PatternModal.html" >PatternModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/PatternsComponent.html" >PatternsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SchematicComponent.html" >SchematicComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SelectionComponent.html" >SelectionComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/ShuttlesModal.html" >ShuttlesModal</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SidebarComponent.html" >SidebarComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SnackbarComponent.html" >SnackbarComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SubdraftComponent.html" >SubdraftComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/SystemsComponent.html" >SystemsComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/TabComponent.html" >TabComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/TopbarComponent.html" >TopbarComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/TreeComponent.html" >TreeComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/UploadFormComponent.html" >UploadFormComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/WeaverComponent.html" >WeaverComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/WeaverDesignComponent.html" >WeaverDesignComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/WeaverViewComponent.html" >WeaverViewComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../components/WeaverViewComponent.html" >WeaverViewComponent</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-code"></span>
                            <span>Directives</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-directives-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-directives-links"
                            >
                                <li class="link">
                                    <a href="../directives/MarqueeComponent.html" >MarqueeComponent</a>
                                </li>
                                <li class="link">
                                    <a href="../directives/SelectionComponent.html" >SelectionComponent</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-file-code-o"></span>
                            <span>Classes</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-classes-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-classes-links"
                            >
                                <li class="link">
                                    <a href="../classes/AdaCADWeaverPage.html" >AdaCADWeaverPage</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Cell.html" >Cell</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Connection.html" >Connection</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Draft.html" >Draft</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Loom.html" >Loom</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Pattern.html" >Pattern</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Point.html" >Point</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Render.html" >Render</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Selection.html" >Selection</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Shape.html" >Shape</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Shuttle.html" >Shuttle</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/System.html" >System</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Timeline.html" >Timeline</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Upload.html" >Upload</a>
                                </li>
                                <li class="link">
                                    <a href="../classes/Util.html" >Util</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../routes.html" ><span class="fa fa-code-fork"></span>Routes</a>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-long-arrow-down"></span>
                            <span>Injectables</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-injectables-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-injectables-links"
                            >
                                <li class="link">
                                    <a href="../injectables/CollectionService.html" >CollectionService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/DesignmodesService.html" >DesignmodesService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/FabricssimService.html" >FabricssimService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/FileService.html" >FileService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/GloballoomService.html" >GloballoomService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/InkService.html" >InkService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/LayersService.html" >LayersService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/MaterialsService.html" >MaterialsService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/NotesService.html" >NotesService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/OperationService.html" >OperationService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/PatternService.html" >PatternService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/PatternfinderService.html" >PatternfinderService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/SystemsService.html" >SystemsService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/TreeService.html" >TreeService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/UploadService.html" >UploadService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/VaeService.html" >VaeService</a>
                                </li>
                                <li class="link">
                                    <a href="../injectables/ViewportService.html" >ViewportService</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-info"></span>
                            <span>Interfaces</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-interfaces-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-interfaces-links"
                            >
                                <li class="link">
                                    <a href="../interfaces/Bounds.html" >Bounds</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Crossing.html" >Crossing</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/CxnComponentProxy.html" >CxnComponentProxy</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DensityUnits.html" >DensityUnits</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DesignActions.html" >DesignActions</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DesignMode.html" >DesignMode</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/DraftMap.html" >DraftMap</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/FileObj.html" >FileObj</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/FileSaver.html" >FileSaver</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Fileloader.html" >Fileloader</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/HistoryState.html" >HistoryState</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Ink.html" >Ink</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Interlacement.html" >Interlacement</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/InterlacementVal.html" >InterlacementVal</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/LoadResponse.html" >LoadResponse</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/LoomCoords.html" >LoomCoords</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/LoomTypes.html" >LoomTypes</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/LoomUpdate.html" >LoomUpdate</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/MaterialMap.html" >MaterialMap</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/MaterialTypes.html" >MaterialTypes</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Model.html" >Model</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/NodeComponentProxy.html" >NodeComponentProxy</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Note.html" >Note</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/OpComponentProxy.html"  class="active" >OpComponentProxy</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Operation.html" >Operation</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/OperationClassification.html" >OperationClassification</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/OperationParams.html" >OperationParams</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Point.html" >Point</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/SaveObj.html" >SaveObj</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/StartOptions.html" >StartOptions</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/StatusMessage.html" >StatusMessage</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/TreeNode.html" >TreeNode</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/TreeNodeProxy.html" >TreeNodeProxy</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/Vertex.html" >Vertex</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/ViewModes.html" >ViewModes</a>
                                </li>
                                <li class="link">
                                    <a href="../interfaces/YarnPath.html" >YarnPath</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <div class="simple">
                            <span class="fa fa-plus"></span>
                            <span>Pipes</span>
                            <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                    data-target="#xs-pipes-links"
                                ></span>
                        </div>
                        <ul class="links collapse in"
                                id="xs-pipes-links"
                            >
                                <li class="link">
                                    <a href="../pipes/FilterPipe.html" >FilterPipe</a>
                                </li>
                        </ul>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../miscellaneous.html" ><span class="fa fa-cubes"></span>Miscellaneous</a>
                    </li>
            
                    <li class="chapter">
                        <a data-type="chapter-link" href="../coverage.html" ><span class="fa fa-tasks"></span>Documentation coverage</a>
                    </li>
            
                    <li class="divider"></li>
                    <li class="copyright">
                            Documentation generated using <a href="https://compodoc.github.io/compodoc/" target="_blank">
                                        <img src="..//images/compodoc-vectorise.svg" class="img-responsive">
                            </a>
                    </li>
            
                </ul>
            
            </nav>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <nav>
                   
                       <ul class="list">
                   
                           <li class="title">
                               <a href="../">adacad-weaver documentation</a>
                           </li>
                   
                           <li class="divider"></li>
                   
                               <div id="book-search-input" role="search">
                                   <input type="text" placeholder="Type to search">
                               </div>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../"><span class="fa fa-home"></span>Getting started</a>
                               <ul class="links">
                                       <li class="link">
                                           <a href="../" ><span class="fa fa-file-text-o"></span>README</a>
                                       </li>
                                       <li class="link">
                                           <a 
                                               
                                                href="../overview.html" 
                                                href="../overview.html" 
                                               >
                                               <span class="fa fa-th"></span>Overview
                                           </a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="./modules.html" >
                                   <span class="fa fa-archive"></span>
                                   <span>Modules</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#modules-links"
                                   ></span>
                               </a>
                               <ul class="links collapse in"
                                       id="modules-links"
                   >
                                       <li class="link">
                                           <a href="../modules/AppModule.html" >AppModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/AppRoutingModule.html" >AppRoutingModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/CoreModule.html" >CoreModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/MixerModule.html" >MixerModule</a>
                                       </li>
                                       <li class="link">
                                           <a href="../modules/WeaverModule.html" >WeaverModule</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-cogs"></span>
                                   <span>Components</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#components-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="components-links"
                   >
                                       <li class="link">
                                           <a href="../components/AboutModal.html" >AboutModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/ActionsComponent.html" >ActionsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/AppComponent.html" >AppComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/ConnectionComponent.html" >ConnectionComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/ConnectionModal.html" >ConnectionModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/DraftdetailComponent.html" >DraftdetailComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/DraftviewerComponent.html" >DraftviewerComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/ImageComponent.html" >ImageComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/InitModal.html" >InitModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/LoomComponent.html" >LoomComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/LoomModal.html" >LoomModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MaterialModal.html" >MaterialModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MaterialsComponent.html" >MaterialsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerComponent.html" >MixerComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerDesignComponent.html" >MixerDesignComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerInitComponent.html" >MixerInitComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerPatternsComponent.html" >MixerPatternsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerViewComponent.html" >MixerViewComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MixerViewComponent.html" >MixerViewComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/MlModal.html" >MlModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/NoteComponent.html" >NoteComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/NotesComponent.html" >NotesComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/OpHelpModal.html" >OpHelpModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/OperationComponent.html" >OperationComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/OpsComponent.html" >OpsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/PaletteComponent.html" >PaletteComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/PatternModal.html" >PatternModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/PatternsComponent.html" >PatternsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SchematicComponent.html" >SchematicComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SelectionComponent.html" >SelectionComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/ShuttlesModal.html" >ShuttlesModal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SidebarComponent.html" >SidebarComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SnackbarComponent.html" >SnackbarComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SubdraftComponent.html" >SubdraftComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/SystemsComponent.html" >SystemsComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/TabComponent.html" >TabComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/TopbarComponent.html" >TopbarComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/TreeComponent.html" >TreeComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/UploadFormComponent.html" >UploadFormComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/WeaverComponent.html" >WeaverComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/WeaverDesignComponent.html" >WeaverDesignComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/WeaverViewComponent.html" >WeaverViewComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../components/WeaverViewComponent.html" >WeaverViewComponent</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-code"></span>
                                   <span>Directives</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#directives-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="directives-links"
                   >
                                       <li class="link">
                                           <a href="../directives/MarqueeComponent.html" >MarqueeComponent</a>
                                       </li>
                                       <li class="link">
                                           <a href="../directives/SelectionComponent.html" >SelectionComponent</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-file-code-o"></span>
                                   <span>Classes</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#classes-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="classes-links"
                   >
                                       <li class="link">
                                           <a href="../classes/AdaCADWeaverPage.html" >AdaCADWeaverPage</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Cell.html" >Cell</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Connection.html" >Connection</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Draft.html" >Draft</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Loom.html" >Loom</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Pattern.html" >Pattern</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Point.html" >Point</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Render.html" >Render</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Selection.html" >Selection</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Shape.html" >Shape</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Shuttle.html" >Shuttle</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/System.html" >System</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Timeline.html" >Timeline</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Upload.html" >Upload</a>
                                       </li>
                                       <li class="link">
                                           <a href="../classes/Util.html" >Util</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../routes.html" ><span class="fa fa-code-fork"></span>Routes</a>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-long-arrow-down"></span>
                                   <span>Injectables</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#injectables-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="injectables-links"
                   >
                                       <li class="link">
                                           <a href="../injectables/CollectionService.html" >CollectionService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/DesignmodesService.html" >DesignmodesService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/FabricssimService.html" >FabricssimService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/FileService.html" >FileService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/GloballoomService.html" >GloballoomService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/InkService.html" >InkService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/LayersService.html" >LayersService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/MaterialsService.html" >MaterialsService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/NotesService.html" >NotesService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/OperationService.html" >OperationService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/PatternService.html" >PatternService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/PatternfinderService.html" >PatternfinderService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/SystemsService.html" >SystemsService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/TreeService.html" >TreeService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/UploadService.html" >UploadService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/VaeService.html" >VaeService</a>
                                       </li>
                                       <li class="link">
                                           <a href="../injectables/ViewportService.html" >ViewportService</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-info"></span>
                                   <span>Interfaces</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#interfaces-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="interfaces-links"
                   >
                                       <li class="link">
                                           <a href="../interfaces/Bounds.html" >Bounds</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Crossing.html" >Crossing</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/CxnComponentProxy.html" >CxnComponentProxy</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DensityUnits.html" >DensityUnits</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DesignActions.html" >DesignActions</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DesignMode.html" >DesignMode</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/DraftMap.html" >DraftMap</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/FileObj.html" >FileObj</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/FileSaver.html" >FileSaver</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Fileloader.html" >Fileloader</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/HistoryState.html" >HistoryState</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Ink.html" >Ink</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Interlacement.html" >Interlacement</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/InterlacementVal.html" >InterlacementVal</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/LoadResponse.html" >LoadResponse</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/LoomCoords.html" >LoomCoords</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/LoomTypes.html" >LoomTypes</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/LoomUpdate.html" >LoomUpdate</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/MaterialMap.html" >MaterialMap</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/MaterialTypes.html" >MaterialTypes</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Model.html" >Model</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/NodeComponentProxy.html" >NodeComponentProxy</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Note.html" >Note</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/OpComponentProxy.html"  class="active" >OpComponentProxy</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Operation.html" >Operation</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/OperationClassification.html" >OperationClassification</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/OperationParams.html" >OperationParams</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Point.html" >Point</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/SaveObj.html" >SaveObj</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/StartOptions.html" >StartOptions</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/StatusMessage.html" >StatusMessage</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/TreeNode.html" >TreeNode</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/TreeNodeProxy.html" >TreeNodeProxy</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/Vertex.html" >Vertex</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/ViewModes.html" >ViewModes</a>
                                       </li>
                                       <li class="link">
                                           <a href="../interfaces/YarnPath.html" >YarnPath</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <div class="simple">
                                   <span class="fa fa-plus"></span>
                                   <span>Pipes</span>
                                   <span class="menu-toggler fa fa-angle-up" data-toggle="collapse"
                                           data-target="#pipes-links"
                   ></span>
                               </div>
                               <ul class="links collapse in"
                                       id="pipes-links"
                   >
                                       <li class="link">
                                           <a href="../pipes/FilterPipe.html" >FilterPipe</a>
                                       </li>
                               </ul>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../miscellaneous.html" ><span class="fa fa-cubes"></span>Miscellaneous</a>
                           </li>
                   
                           <li class="chapter">
                               <a data-type="chapter-link" href="../coverage.html" ><span class="fa fa-tasks"></span>Documentation coverage</a>
                           </li>
                   
                           <li class="divider"></li>
                           <li class="copyright">
                                   Documentation generated using <a href="https://compodoc.github.io/compodoc/" target="_blank">
                                               <img src="..//images/compodoc-vectorise.svg" class="img-responsive">
                                   </a>
                           </li>
                   
                       </ul>
                   
                   </nav>
               </div>
               <div class="content interface">
                   <div class="content-data">







<ol class="breadcrumb">
  <li>Interfaces</li>
  <li>OpComponentProxy</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
    <li class="active">
        <a href="#infos" id="infos-tab" role="tab" data-toggle="tab">Infos</a>
    </li>
    <li>
        <a href="#source" role="tab" id="source-tab" data-toggle="tab">Source</a>
    </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="infos">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/core/provider/file.service.ts</code>
        </p>





            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <b>name</b>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>name:     <code>string</code>
</bcode>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>string</code>

                                        </td>
                                    </tr>



                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <b>node_id</b>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>node_id:     <code>number</code>
</bcode>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>number</code>

                                        </td>
                                    </tr>



                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <b>params</b>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>params:     <code>number[]</code>
</bcode>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>    <code>number[]</code>

                                        </td>
                                    </tr>



                        </tbody>
                    </table>
            </section>
    </div>
    <div class="tab-pane fade tab-source-code" id="source">
        <pre><code class="hljs javascript">import { Injectable } from &#x27;@angular/core&#x27;;
import { isBuffer } from &#x27;lodash&#x27;;
import { TreeService } from &#x27;../../mixer/provider/tree.service&#x27;;
import { Cell } from &#x27;../model/cell&#x27;;
import { Bounds, Interlacement } from &#x27;../model/datatypes&#x27;;
import { Draft } from &#x27;../model/draft&#x27;;
import { Loom } from &#x27;../model/loom&#x27;;
import { Pattern } from &#x27;../model/pattern&#x27;;
import { Shuttle } from &#x27;../model/shuttle&#x27;;
import utilInstance from &#x27;../model/util&#x27;;
import { MaterialMap, MaterialsService } from &#x27;./materials.service&#x27;;
import { SystemsService } from &#x27;./systems.service&#x27;;
import { Note, NotesService } from &#x27;./notes.service&#x27;;
import { PatternService } from &#x27;./pattern.service&#x27;;
import { System } from &#x27;../model/system&#x27;;


 export interface NodeComponentProxy{
  node_id: number,
  type: string,
  bounds: Bounds; 
  draft_id: number;
  draft_visible: boolean;
 }

 export interface TreeNodeProxy{
  node: number,
  parent: number; 
  inputs: Array&lt;number&gt;;
  outputs: Array&lt;number&gt;; 
 }

 export interface OpComponentProxy{
  node_id: number,
  name: string,
  params: Array&lt;number&gt;; 
 }

 export interface CxnComponentProxy{
  from: number,
  to: number
 }


 export interface SaveObj{
  type: string,
  nodes: Array&lt;NodeComponentProxy&gt;,
  tree: Array&lt;TreeNodeProxy&gt;,
  drafts: Array&lt;Draft&gt;,
  looms: Array&lt;Loom&gt;,
  patterns: Array&lt;Pattern&gt;, 
  ops: Array&lt;any&gt;;
  notes: Array&lt;Note&gt;
  materials: Array&lt;Shuttle&gt;
 }

export interface FileObj{
 nodes: Array&lt;NodeComponentProxy&gt;,
 treenodes: Array&lt;TreeNodeProxy&gt;,
 drafts: Array&lt;Draft&gt;,
 looms: Array&lt;Loom&gt;,
 ops: Array&lt;OpComponentProxy&gt;
}

interface StatusMessage{
  id: number,
  message: string,
  success: boolean
}

export interface LoadResponse{
  data: FileObj,
  status: number;
}



interface Fileloader{
  ada: (data: any) &#x3D;&gt; Promise&lt;LoadResponse&gt;,
  wif: (data: any) &#x3D;&gt; Promise&lt;LoadResponse&gt;,
  bmp: (data: any) &#x3D;&gt; Promise&lt;LoadResponse&gt;,
  jpg: (data: any) &#x3D;&gt; Promise&lt;LoadResponse&gt;,
  form: (data: any) &#x3D;&gt; Promise&lt;LoadResponse&gt;
}

interface FileSaver{
  ada: (type: string, drafts: Array&lt;Draft&gt;, looms: Array&lt;Loom&gt;, for_timeline:boolean) &#x3D;&gt; Promise&lt;string&gt;,
  wif: (draft: Draft, loom: Loom) &#x3D;&gt; Promise&lt;string&gt;,
  bmp: (canvas: HTMLCanvasElement) &#x3D;&gt; Promise&lt;string&gt;,
  jpg: (canvas: HTMLCanvasElement) &#x3D;&gt; Promise&lt;string&gt;
}


/**
 * this service handles the processing of data from an uplaoded file. 
 * It is called from the InitModal when the user uploads data. 
 * The principle sholud be that you can load any .ada file into 
 * mixer or weaver, no matter what. 
 */

@Injectable({
  providedIn: &#x27;root&#x27;
})
export class FileService {


  status: Array&lt;StatusMessage&gt; &#x3D; [];
  loader: Fileloader &#x3D; null;
  saver: FileSaver &#x3D; null;


  constructor(
    private tree: TreeService, 
    private ns: NotesService,
    private ps: PatternService,
    private ms: MaterialsService,
    private ss: SystemsService) { 
  
  this.status &#x3D; [
    {id: 0, message: &#x27;success&#x27;, success: true},
    {id: 1, message: &#x27;incompatable type&#x27;, success: false}
  ];


  const dloader: Fileloader &#x3D; {

     ada: async (data: any) : Promise&lt;LoadResponse&gt; &#x3D;&gt; {

      let drafts: Array&lt;Draft&gt; &#x3D; [];
      let looms: Array&lt;Loom&gt; &#x3D; [];
      let ops: Array&lt;OpComponentProxy&gt; &#x3D; [];
     

      if(data.notes !&#x3D;&#x3D; undefined) this.ns.reloadNotes(data.notes);
      else this.ns.resetNotes(); 
      

      //handle old file types that didn&#x27;t separate out drafts
      if(data.drafts &#x3D;&#x3D;&#x3D; undefined) data.drafts &#x3D; [data];


      drafts &#x3D; data.drafts.map(draftdata &#x3D;&gt; {
        const draft: Draft &#x3D;  new Draft({wefts: draftdata.wefts, warps: draftdata.warps, pattern: draftdata.pattern});
       
        if(draftdata.id !&#x3D;&#x3D; undefined) draft.overloadId(draftdata.id);
        if(draftdata.name !&#x3D;&#x3D; undefined) draft.overloadName(draftdata.name);
        
        if(draftdata.shuttles !&#x3D;&#x3D; undefined){
            //if there is only one draft here we are loading into the mixer and should add materials
          if(data.drafts.length &#x3D;&#x3D;&#x3D; 1){
            const mapping:Array&lt;MaterialMap&gt; &#x3D; this.ms.addShuttles(draftdata.shuttles);
            draft.rowShuttleMapping &#x3D; utilInstance.updateMaterialIds(draftdata.rowShuttleMapping, mapping, 0);
            draft.colShuttleMapping &#x3D; utilInstance.updateMaterialIds(draftdata.colShuttleMapping, mapping, 0);
            
          }else{
           this.ms.overloadShuttles(data.shuttles); 
          }

        }else{
          if(data.materials !&#x3D;&#x3D; undefined){
             //if there is only one draft here we are loading into the mixer and should add materials
            if(data.drafts.length &#x3D;&#x3D;&#x3D; 1){
              const mapping:Array&lt;MaterialMap&gt; &#x3D; this.ms.addShuttles(data.materials);
              draft.rowShuttleMapping &#x3D; utilInstance.updateMaterialIds(draftdata.rowShuttleMapping, mapping, 0);
              draft.colShuttleMapping &#x3D; utilInstance.updateMaterialIds(draftdata.colShuttleMapping, mapping, 0);

            }else{
              this.ms.overloadShuttles(data.materials); 
            }
          }
        }

        //scan the systems and add any that need to be added
        if(draftdata.rowSystemMapping !&#x3D;&#x3D; undefined){
          
          draftdata.rowSystemMapping.forEach(el &#x3D;&gt; {
            if(this.ss.getWeftSystem(el) &#x3D;&#x3D;&#x3D; undefined) this.ss.addWeftSystemFromId(el);
          });

          draft.overloadRowSystemMapping(draftdata.rowSystemMapping);
        }  

          //scan the systems and add any that need to be added
          if(draftdata.colSystemMapping !&#x3D;&#x3D; undefined){
          
            draftdata.colSystemMapping.forEach(el &#x3D;&gt; {
              if(this.ss.getWarpSystem(el) &#x3D;&#x3D;&#x3D; undefined) this.ss.addWarpSystemFromId(el);
            });
  
            draft.overloadColSystemMapping(draftdata.rowSystemMapping);
          }  
  

        console.log(&quot;draft data&quot;, draftdata);

        if(draftdata.rowShuttleMapping !&#x3D;&#x3D; undefined) draft.overloadRowShuttleMapping(draftdata.rowShuttleMapping); 
        if(draftdata.colShuttleMapping !&#x3D;&#x3D; undefined) draft.overloadColShuttleMapping(draftdata.colShuttleMapping); 
        // if(draftdata.rowSystemMapping !&#x3D;&#x3D; undefined) draft.overloadRowSystemMapping(draftdata.rowSystemMapping); 
        // if(draftdata.colSystemMapping !&#x3D;&#x3D; undefined) draft.overloadColSystemMapping(draftdata.colSystemMapping);
        if(draftdata.notes !&#x3D;&#x3D; undefined) draft.overloadNotes(draftdata.notes);

        return draft; 

      });


      if(data.looms &#x3D;&#x3D;&#x3D; undefined || data.looms.length &#x3D;&#x3D;&#x3D; 0) data.looms &#x3D; [];

      looms &#x3D; data.looms.map((data, ndx) &#x3D;&gt; {

        let draft: Draft &#x3D; null;
        if(data.draft_id !&#x3D;&#x3D; undefined) draft &#x3D; drafts.find(draft &#x3D;&gt; draft.id &#x3D;&#x3D;&#x3D; data.draft_id);

        const frames: number &#x3D; (data.min_frames &#x3D;&#x3D;&#x3D; undefined) ? 8 : data.min_frames;
        const treadles: number &#x3D; (data.min_treadles &#x3D;&#x3D;&#x3D; undefined) ? 8 : data.min_treadles;

        const loom &#x3D; new Loom(draft, frames, treadles);
        if(data.type !&#x3D;&#x3D; undefined) loom.overloadType(data.type); 
        if(data.threading !&#x3D;&#x3D; undefined) loom.overloadThreading(data.threading);
        if(data.treadling !&#x3D;&#x3D; undefined) loom.overloadTreadling(data.treadling);
        if(data.tieup !&#x3D;&#x3D; undefined) loom.overloadTieup(data.tieup);
        return loom;
      });

      if(data.patterns !&#x3D;&#x3D; undefined){
        const patterns: Array&lt;Pattern&gt; &#x3D; data.patterns.map(pattern &#x3D;&gt; {
          const p:Pattern &#x3D; new Pattern(pattern);
          return p;
        });
        this.ps.overridePatterns(patterns)
      }else{
        this.ps.resetPatterns();
      }


      if(data.ops !&#x3D;&#x3D; undefined){
        ops &#x3D; data.ops.map(data &#x3D;&gt; {
          const op: OpComponentProxy &#x3D; {
            node_id: data.node_id,
            name: data.name,
            params: data.params
          }
          return op;
        });
      }


      const envt: FileObj &#x3D; {
        drafts: drafts,
        looms: looms,
        nodes: (data.nodes &#x3D;&#x3D;&#x3D; undefined) ? [] : data.nodes,
        treenodes: (data.tree &#x3D;&#x3D;&#x3D; undefined) ? [] : data.tree,
        ops: ops
      }

      return Promise.resolve({data: envt, status: 0}); 


    }, 
    wif: async (data: any) : Promise&lt;LoadResponse&gt; &#x3D;&gt; {

      let drafts: Array&lt;Draft&gt; &#x3D; [];
      let looms: Array&lt;Loom&gt; &#x3D; [];
     
      var stringWithoutMetadata &#x3D; utilInstance.getSubstringAfter(&quot;CONTENTS&quot;, data);
      const warps:number &#x3D; utilInstance.getInt(&quot;Threads&quot;,utilInstance.getSubstringAfter(&quot;WARP]&quot;,stringWithoutMetadata));
      const wefts:number &#x3D; utilInstance.getInt(&quot;Threads&quot;,utilInstance.getSubstringAfter(&quot;WEFT]&quot;,stringWithoutMetadata));
      const pattern: Array&lt;Array&lt;Cell&gt;&gt; &#x3D; [];
      
      this.ns.resetNotes(); 
      this.ps.resetPatterns();

      for (var i &#x3D; 0; i &lt; wefts; i++) {
        pattern.push([]);
        for (var j &#x3D; 0; j &lt; warps; j++) {
          pattern[i].push(new Cell(null));
          pattern[i][j].setHeddle(false);
        }
      }
      const draft &#x3D; new Draft({wefts: wefts, warps: warps, pattern: pattern});
      drafts.push(draft);
      draft.overloadName(data.name);

    let frames &#x3D; utilInstance.getInt(&quot;Shafts&quot;, data);
    let treadles &#x3D; utilInstance.getInt(&quot;Treadles&quot;, data);
    
    const loom:Loom &#x3D; new Loom(draft, frames, treadles);
    loom.overloadType(&#x27;frame&#x27;);
    looms.push(loom);

    // draft.loom.tieup &#x3D; []

    // for (var i &#x3D; 0; i &lt; frames; i++) {
    //   draft.loom.tieup.push([]);
    //   for (var j &#x3D; 0; j &lt; treadles; j++) {
    //     draft.loom.tieup[i].push(false);
    //   }
    // }

    if (utilInstance.getBool(&quot;TREADLING&quot;, stringWithoutMetadata)) {
      var treadling &#x3D; utilInstance.getTreadling(stringWithoutMetadata, draft);
      loom.overloadTreadling(treadling);
    }
    if (utilInstance.getBool(&quot;THREADING&quot;, stringWithoutMetadata)) {
      var threading &#x3D; utilInstance.getThreading(stringWithoutMetadata, draft);
      loom.overloadThreading(threading);
    }
    if (utilInstance.getBool(&quot;TIEUP&quot;, data)) {
      var tieups &#x3D; utilInstance.getTieups(stringWithoutMetadata, draft);
      loom.overloadTieup(tieups);

    }
    if (utilInstance.getBool(&quot;COLOR TABLE&quot;,data)) {
      if (utilInstance.getString(&quot;Form&quot;, data) &#x3D;&#x3D;&#x3D; &quot;RGB&quot;) {
        let color_table: Array&lt;Shuttle&gt;  &#x3D; utilInstance.getColorTable(data);
        var shuttles &#x3D; color_table;

        /** TODO: Update this to add, not overwrite, shuttles */
        this.ms.overloadShuttles(shuttles);
        draft.overloadRowShuttleMapping(utilInstance.getRowToShuttleMapping(data, draft));
        draft.overloadColShuttleMapping(utilInstance.getColToShuttleMapping(data, draft));
      }
    }

    draft.recalculateDraft(tieups, treadling, threading);


    const proxies &#x3D; this.tree.getNewDraftProxies(draft, []);

    
    const f: FileObj &#x3D; {
      drafts: drafts,
      looms: looms,
      nodes: [proxies.node], 
      treenodes: [proxies.treenode],
      ops: []
    }


    return Promise.resolve({data: f ,status: 0});
    },
    /**
     * takes in a jpg, creates as many drafts as there are unique colors in the image. 
     * @param data 
     * @returns 
     */
    jpg: async (data: any) : Promise&lt;LoadResponse&gt; &#x3D;&gt; {
      console.log(&quot;processing JPG data&quot;)
      let drafts: Array&lt;Draft&gt; &#x3D; [];
      let looms: Array&lt;Loom&gt; &#x3D; [];
      let nodes: Array&lt;NodeComponentProxy&gt; &#x3D; [];
      let treenodes: Array&lt;TreeNodeProxy&gt; &#x3D; [];

      this.ns.resetNotes(); 
      this.ps.resetPatterns();

      let e &#x3D; data;
      const warps &#x3D; e.width;
      const wefts &#x3D; e.height;
  
      var img &#x3D; e.data;

      let hex_string: string &#x3D; &quot;&quot;;
      const img_as_hex: Array&lt;string&gt; &#x3D; [];
      img.forEach((el, ndx) &#x3D;&gt; {
        hex_string &#x3D; hex_string + el.toString(16);
        if(ndx % 4 &#x3D;&#x3D;&#x3D; 3){
          img_as_hex.push(hex_string);
          hex_string &#x3D; &quot;&quot;;
        }

      });


      //the color table is a unique list of all the colors in this image
      const seen: Array&lt;string&gt; &#x3D; [];
      const color_table: Array&lt;string&gt; &#x3D; img_as_hex.filter((el, ndx) &#x3D;&gt; {
        if(seen.find(seen &#x3D;&gt; seen &#x3D;&#x3D;&#x3D; el) &#x3D;&#x3D;&#x3D; undefined){
          seen.push(el);
          return true;
        }
      });
      console.log(&quot;color table&quot;, color_table);


      //create a draft for each color table
      color_table.forEach(color &#x3D;&gt; {
        const draft: Draft &#x3D; new Draft({warps: warps, wefts: wefts});
        console.log(draft);
        img_as_hex.forEach((el, ndx)&#x3D;&gt;{
          const r: number &#x3D; Math.floor(ndx/warps);
          const c: number &#x3D; ndx % warps;
          if(el &#x3D;&#x3D;&#x3D; color) draft.pattern[r][c].setHeddleUp();
          else draft.pattern[r][c].unsetHeddle();
        });
        drafts.push(draft);
        const loom:Loom &#x3D; new Loom(draft, 8, 10);
        loom.overloadType(&#x27;jacquard&#x27;);
        looms.push(loom);
      })



  
      // for (var i&#x3D;0; i&lt; e.height; i++) {
      //   pattern.push([]);
      //   for (var j&#x3D;0; j&lt; e.width; j++) {
      //     var idx &#x3D; (i * 4 * warps) + (j * 4);
      //     var threshold &#x3D; (img[idx] + img[idx+1] + img[idx+2]);
      //     var alpha &#x3D; img[idx + 3];
  
      //     if (threshold &lt; 750 &amp;&amp; alpha !&#x3D; 0) {
      //       pattern[i].push(new Cell(true));
      //     } else {
      //       pattern[i].push(new Cell(false));
      //     }
      //   }
      // }
  
      // const draft: Draft &#x3D; new Draft({warps: warps, wefts: wefts, pattern: pattern});
      // drafts.push(draft);
      
      // //create a blank loom to accompany this
      // const loom:Loom &#x3D; new Loom(draft, 8, 10);
      // loom.overloadType(&#x27;jacquard&#x27;);
      // looms.push(loom);


      const f: FileObj &#x3D; {
        drafts: drafts,
        looms: looms,
        nodes: [], 
        treenodes: [],
        ops: []
      }
  
      return Promise.resolve({data: f ,status: 0});  
    },
    bmp: async (data: any) : Promise&lt;LoadResponse&gt; &#x3D;&gt; {

      let drafts: Array&lt;Draft&gt; &#x3D; [];
      let looms: Array&lt;Loom&gt; &#x3D; [];

      this.ns.resetNotes(); 
      this.ps.resetPatterns();


      let e &#x3D; data;
      const warps &#x3D; e.width;
      const wefts &#x3D; e.height;
  
      var img &#x3D; e.data;
      var pattern &#x3D; [];
  
      for (var i&#x3D;0; i&lt; e.height; i++) {
        pattern.push([]);
        for (var j&#x3D;0; j&lt; e.width; j++) {
          var idx &#x3D; (i * 4 * warps) + (j * 4);
          var threshold &#x3D; (img[idx] + img[idx+1] + img[idx+2]);
          var alpha &#x3D; img[idx + 3];
  
          if (threshold &lt; 750 &amp;&amp; alpha !&#x3D; 0) {
            pattern[i].push(new Cell(true));
          } else {
            pattern[i].push(new Cell(false));
          }
        }
      }
  
      const draft: Draft &#x3D; new Draft({warps: warps, wefts: wefts, pattern: pattern});
      drafts&#x3D; [ draft];
      
      //create a blank loom to accompany this
      const loom:Loom &#x3D; new Loom(draft, 8, 10);
      loom.overloadType(&#x27;jacquard&#x27;);
      looms.push(loom);

      const proxies &#x3D; this.tree.getNewDraftProxies(draft, []);

    
      const f: FileObj &#x3D; {
        drafts: drafts,
        looms: looms,
        nodes: [proxies.node], 
        treenodes: [proxies.treenode],
        ops: []
      }
  
      return Promise.resolve({data: f ,status: 0});  
    },
    form: async (f:any):Promise&lt;LoadResponse&gt; &#x3D;&gt;{

      let drafts: Array&lt;Draft&gt; &#x3D; [];
      let looms: Array&lt;Loom&gt; &#x3D; [];

      this.ns.resetNotes(); 
      this.ps.resetPatterns();

      var warps &#x3D; 20;
      if(f.value.warps !&#x3D;&#x3D; undefined) warps &#x3D; f.value.warps;


      var wefts &#x3D; 20;
      if(f.value.wefts !&#x3D;&#x3D; undefined) wefts &#x3D; f.value.wefts;
      //set default values

      const draft: Draft &#x3D; new Draft({warps: warps, wefts: wefts});
      drafts.push(draft);

      const randomColor &#x3D; Math.floor(Math.random()*16777215).toString(16);
      let s0 &#x3D; new Shuttle({id: 0, name: &#x27;Color 1&#x27;, type: 0,  thickness:50, color: &#x27;#333333&#x27;, visible: true, insert:false, notes: &quot;&quot;});
      let s1 &#x3D; new Shuttle({id: 1, name: &#x27;Color 2&#x27;, type: 0, thickness:50, color: &#x27;#&#x27;+randomColor, visible:true, insert:false, notes: &quot;&quot;});
      let s2 &#x3D; new Shuttle({id: 2, name: &#x27;Conductive&#x27;, type: 1, thickness:50, color: &#x27;#61c97d&#x27;, visible:true, insert:false, notes: &quot;&quot;});
      
      this.ms.addShuttle(s0);
      this.ms.addShuttle(s1);
      this.ms.addShuttle(s2);


      this.ms.overloadShuttles([s0, s1, s2]);

      var frame_num &#x3D; (f.value.frame_num &#x3D;&#x3D;&#x3D; undefined) ? 8 : f.value.frame_num;
      var treadle_num &#x3D; (f.value.treadle_num &#x3D;&#x3D;&#x3D; undefined) ? 10 : f.value.treadle_num;
      

      const loom: Loom &#x3D; new Loom(draft, frame_num, treadle_num);
      looms.push(loom);

      var loomtype &#x3D; &quot;jacquard&quot;;
      if(f.value.loomtype !&#x3D;&#x3D; undefined || f.value.loomtype) loom.overloadType(f.value.loomtype);
  
  
     // var loomtype &#x3D; (f.value.loomtype &#x3D;&#x3D;&#x3D; undefined || !f.value.loomtype) ? &quot;frame&quot; : f.value.loomtype;
      var frame_num &#x3D; (f.value.frame_num &#x3D;&#x3D;&#x3D; undefined) ? 2 : f.value.frame_num;
      var treadle_num &#x3D; (f.value.treadle_num &#x3D;&#x3D;&#x3D; undefined) ? 2 : f.value.treadle_num;
      
  

      var epi &#x3D; (f.value.epi &#x3D;&#x3D;&#x3D; undefined) ? 10 : f.value.epi;
      var units &#x3D; (f.value.units &#x3D;&#x3D;&#x3D; undefined || ! f.value.units) ? &quot;in&quot; : f.value.units;
      
      loom.overloadEpi(epi);
      loom.overloadUnits(units);
    

      const proxies &#x3D; this.tree.getNewDraftProxies(draft, []);

    
      const envt: FileObj &#x3D; {
        drafts: drafts,
        looms: looms,
        nodes: [proxies.node], 
        treenodes: [proxies.treenode],
        ops: []
      }
    

      return Promise.resolve({data: envt, status: 0});
    }
  }

  // interface FileSaver{
  //   ada: (drafts: Array&lt;Draft&gt;, looms: Array&lt;Loom&gt;, pattern: Array&lt;Pattern&gt;, palette:PaletteComponent) &#x3D;&gt; void,
  //   wif: (drafts: Array&lt;Draft&gt;, looms: Array&lt;Loom&gt;) &#x3D;&gt; void,
  //   bmp: (drafts: Array&lt;Draft&gt;) &#x3D;&gt; LoadResponse,
  //   jpg: (drafts: Array&lt;Draft&gt;, looms: Array&lt;Loom&gt;, pattern: Array&lt;Pattern&gt;, palette:PaletteComponent) &#x3D;&gt; void
  // }
  

  const dsaver: FileSaver &#x3D; {
     ada:  async (type: string, drafts: Array&lt;Draft&gt;, looms: Array&lt;Loom&gt;,  for_timeline: boolean) : Promise&lt;string&gt; &#x3D;&gt; {
      //eventually need to add saved patterns here as well
      const out: SaveObj &#x3D; {
        type: type,
        drafts: drafts,
        looms: looms,
        patterns: this.ps.exportPatternsForSaving(),
        nodes: this.tree.exportNodesForSaving(),
        tree: this.tree.exportTreeForSaving(),
        ops: this.tree.exportOpMetaForSaving(),
        notes: this.ns.exportForSaving(),
        materials: this.ms.exportForSaving()
      }


      var theJSON &#x3D; JSON.stringify(out);
      if(for_timeline) return Promise.resolve(theJSON);

      const href:string &#x3D; &quot;data:application/json;charset&#x3D;UTF-8,&quot; + encodeURIComponent(theJSON);
      return href;
    },
    wif: async (draft: Draft, loom: Loom) : Promise&lt;string&gt; &#x3D;&gt; {
      const shuttles: Array&lt;Shuttle&gt; &#x3D; this.ms.getShuttles();
        //will need to import the obj for draft2wif.ts and then use it and pass this.weave for fileContents
      var fileContents &#x3D; &quot;[WIF]\nVersion&#x3D;1.1\nDate&#x3D;November 6, 2020\nDevelopers&#x3D;Unstable Design Lab at the University of Colorado Boulder\nSource Program&#x3D;AdaCAD\nSource Version&#x3D;3.0\n[CONTENTS]&quot;;
      var fileType &#x3D; &quot;text/plain&quot;;

      fileContents +&#x3D; &quot;\nCOLOR PALETTE&#x3D;yes\nWEAVING&#x3D;yes\nWARP&#x3D;yes\nWEFT&#x3D;yes\nTIEUP&#x3D;yes\nCOLOR TABLE&#x3D;yes\nTHREADING&#x3D;yes\nWARP COLORS&#x3D;yes\nTREADLING&#x3D;yes\nWEFT COLORS&#x3D;yes\n&quot;;
      
      fileContents +&#x3D; &quot;[COLOR PALETTE]\n&quot;;
      fileContents +&#x3D; &quot;Entries&#x3D;&quot; + (shuttles.length).toString() +&quot;\n&quot;;
      fileContents +&#x3D; &quot;Form&#x3D;RGB\nRange&#x3D;0,255\n&quot;;

      fileContents +&#x3D; &quot;[WEAVING]\nShafts&#x3D;&quot;;
      fileContents +&#x3D; loom.min_frames.toString();
      fileContents +&#x3D; &quot;\nTreadles&#x3D;&quot;;
      fileContents +&#x3D; loom.min_treadles.toString();
      fileContents +&#x3D; &quot;\nRising Shed&#x3D;yes\n&quot;;
      fileContents +&#x3D; &quot;[WARP]\nThreads&#x3D;&quot;;
      fileContents +&#x3D; draft.warps.toString();
      
      var warpColors &#x3D; [];
      for (var i &#x3D; 0; i &lt; draft.colShuttleMapping.length; i++) {
        if (!warpColors.includes(draft.colShuttleMapping[i])) {
          warpColors.push(draft.colShuttleMapping[i]);
        }
      }
      fileContents +&#x3D; &quot;\nColors&#x3D;&quot; + warpColors.length.toString();

      fileContents +&#x3D; &quot;\n[WEFT]\nThreads&#x3D;&quot;;
      fileContents +&#x3D; draft.wefts.toString();
      var weftColors &#x3D; [];
      for (var i &#x3D; 0; i &lt; draft.colShuttleMapping.length; i++) {
        if (!weftColors.includes(draft.colShuttleMapping[i])) {
          weftColors.push(draft.colShuttleMapping[i]);
        }
      }
      fileContents +&#x3D; &quot;\nColors&#x3D;&quot; + weftColors.length.toString();

      fileContents +&#x3D; &quot;\n[TIEUP]\n&quot;;

      var treadles &#x3D; [];
      for (var i &#x3D;0; i &lt; loom.tieup.length;i++) {
        for (var j &#x3D; 0; j &lt; loom.tieup[i].length;j++) {
          if (loom.tieup[i][j] &amp;&amp; !treadles.includes(j)) {
            treadles.push(j);
          }
        }
      }
      for (var i &#x3D;0; i &lt; treadles.length; i++) {
        fileContents +&#x3D; (treadles[i]+1).toString() + &quot;&#x3D;&quot;;
        var lineMarked &#x3D; false;
        for (var j &#x3D; 0; j &lt; loom.tieup.length; j++){
          if (loom.tieup[j][treadles[i]]) { 
            if (lineMarked) {
              fileContents +&#x3D; &quot;,&quot;;
            }
            fileContents +&#x3D; (j+1).toString();
            lineMarked&#x3D;true;
          }
        }
        fileContents +&#x3D; &quot;\n&quot;;
      }

      fileContents+&#x3D; &quot;[COLOR TABLE]\n&quot;;
      //Reference: https://css-tricks.com/converting-color-spaces-in-javascript/ for conversion for hex to RGB
      var counter &#x3D; 1;
      for (var i &#x3D; 0; i &lt; shuttles.length; i++) {
        fileContents+&#x3D; (counter).toString();
        counter &#x3D; counter + 1;
        fileContents+&#x3D; &quot;&#x3D;&quot;;
        var hex &#x3D; shuttles[i].color;
        if (hex.length &#x3D;&#x3D; 7) {
          var r &#x3D; &quot;0x&quot; + hex[1] + hex[2];
          var g &#x3D; &quot;0x&quot; + hex[3] + hex[4];
          var b &#x3D; &quot;0x&quot; + hex[5] + hex[6];

          fileContents +&#x3D; (+r).toString() + &quot;,&quot; + (+g).toString() + &quot;,&quot; + (+b).toString() + &quot;\n&quot;;
        }
      }
      
      fileContents +&#x3D; &quot;[THREADING]\n&quot;;
      for (var i&#x3D;0; i &lt;loom.threading.length; i++) {
        var frame &#x3D; loom.threading[i];
        if (frame !&#x3D; -1) {
          fileContents +&#x3D; (loom.threading.length-i).toString() + &quot;&#x3D;&quot; + (frame+1).toString() + &quot;\n&quot;;
        }
      }

      fileContents +&#x3D; &quot;[WARP COLORS]\n&quot;;
      for (var i &#x3D; 0; i &lt; draft.colShuttleMapping.length; i++) {
        fileContents +&#x3D; (i+1).toString() + &quot;&#x3D;&quot; + (draft.colShuttleMapping[(draft.colShuttleMapping.length)-(i+1)]+1).toString() + &quot;\n&quot;;
      }

      fileContents +&#x3D; &quot;[TREADLING]\n&quot;;
      for (var i &#x3D; 0; i &lt; loom.treadling.length; i++) {
        if (loom.treadling[i] !&#x3D; null &amp;&amp; loom.treadling[i] !&#x3D; -1){
          fileContents +&#x3D; (i+1).toString() + &quot;&#x3D;&quot; + (loom.treadling[i]+1).toString() + &quot;\n&quot;;
        }
      }

      fileContents +&#x3D; &quot;[WEFT COLORS]\n&quot;;
      for (var i &#x3D; 0; i &lt; draft.rowShuttleMapping.length; i++) { // will likely have to change the way I import too
        fileContents +&#x3D; (i+1).toString() + &quot;&#x3D;&quot; + (draft.rowShuttleMapping[i]+1).toString() + &quot;\n&quot;;
      }

      const href:string &#x3D; &quot;data:&quot; + fileType +&quot;;base64,&quot; + btoa(fileContents);
      return Promise.resolve(href);
    },
    bmp: async (canvas:HTMLCanvasElement) : Promise&lt;string&gt; &#x3D;&gt; {
      return Promise.resolve(canvas.toDataURL(&quot;image/jpg&quot;));

    },
    jpg: async (canvas:HTMLCanvasElement) : Promise&lt;string&gt; &#x3D;&gt; {
      return Promise.resolve(canvas.toDataURL(&quot;image/jpg&quot;));
    }
  }


  this.loader &#x3D; dloader;
  this.saver &#x3D; dsaver;
  


  }






}
</code></pre>
    </div>
</div>




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
           </div>
       </div>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/search/search.js"></script>
       <script src="../js/search/lunr.min.js"></script>
       <script src="../js/search/search-lunr.js"></script>

       <script src="../js/menu.js"></script>
       <script src="../js/libs/highlight.pack.js"></script>
       <script src="../js/libs/highlightjs-line-numbers.min.js"></script>
       <script src="../js/search/search_index.js"></script>
       <script>
            document.addEventListener('DOMContentLoaded', function() {
                hljs.initHighlightingOnLoad();
                hljs.initLineNumbersOnLoad();
            });
       </script>

    </body>
</html>
